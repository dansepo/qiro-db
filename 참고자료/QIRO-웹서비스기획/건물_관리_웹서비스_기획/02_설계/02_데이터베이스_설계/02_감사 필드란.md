"감사 필드(Audit Fields)"는 데이터베이스 설계 시 데이터의 변경 이력을 추적하고 관리하기 위해 대부분의 테이블에 공통적으로 포함하는 매우 유용한 필드들입니다.

**감사 필드란?**

감사 필드는 데이터 레코드(행)가 **언제, 누구에 의해 생성되고 수정되었는지**에 대한 메타 정보를 기록하는 컬럼들을 의미합니다. 이 필드들은 주로 다음과 같은 정보를 담습니다:

1. **`createdAt` (생성일시):**
   - 해당 데이터 레코드가 처음 생성된 정확한 날짜와 시간을 기록합니다.
   - 보통 데이터베이스에서 레코드 삽입 시 자동으로 현재 시간이 입력되도록 설정합니다. (예: `TIMESTAMP WITH TIME ZONE DEFAULT CURRENT_TIMESTAMP`)
2. **`createdBy` (생성자):**
   - 해당 데이터 레코드를 생성한 사용자 또는 시스템 프로세스의 식별자를 기록합니다.
   - 로그인한 사용자 ID를 저장하는 경우가 많습니다.
3. **`lastModifiedAt` (최종수정일시) 또는 `updatedAt` (업데이트일시):**
   - 해당 데이터 레코드가 마지막으로 수정된 정확한 날짜와 시간을 기록합니다.
   - 레코드가 업데이트될 때마다 이 필드 값도 현재 시간으로 자동 갱신되도록 설정합니다.
4. **`lastModifiedBy` (최종수정자) 또는 `updatedBy` (업데이트한 사람):**
   - 해당 데이터 레코드를 마지막으로 수정한 사용자 또는 시스템 프로세스의 식별자를 기록합니다.

**감사 필드의 중요성 및 용도:**

- 추적성 및 감사 증적 (Traceability & Audit Trail):
  - 데이터 변경의 전체 이력을 추적할 수 있어, "누가, 언제, 무엇을" 했는지 명확히 알 수 있습니다.
  - 보안 감사나 규정 준수 요구사항(예: 개인정보 변경 이력)을 충족하는 데 필수적입니다.
- 문제 해결 및 디버깅 (Troubleshooting & Debugging):
  - 데이터에 오류가 발생했을 때, 언제 어떤 사용자에 의해 변경되었는지 파악하여 원인 분석 및 문제 해결에 큰 도움을 줍니다.
- 데이터 무결성 (Data Integrity):
  - 비정상적인 데이터 변경이나 오류를 감지하고, 데이터의 신뢰성을 유지하는 데 기여합니다.
- 책임성 (Accountability):
  - 데이터 변경에 대한 책임 소재를 명확히 할 수 있습니다.
- 변경 이력 관리의 기초:
  - 단순 감사 필드만으로도 기본적인 변경 이력을 알 수 있으며, 더 나아가 상세 변경 내역을 별도의 로그 테이블에 기록하는 시스템(데이터 변경 이력 로깅)의 기초가 됩니다.

**일반적인 감사 필드 예시 (데이터베이스 테이블 컬럼명):**

| **한글 명칭**    | **영문 컬럼명 제안** | **데이터 타입 예시 (PostgreSQL)** | **설명**                                            |
| ---------------- | -------------------- | --------------------------------- | --------------------------------------------------- |
| 생성일시         | `created_at`         | `TIMESTAMP WITH TIME ZONE`        | 레코드 생성 시각                                    |
| 생성자 ID        | `created_by`         | `VARCHAR(50)` / `UUID`            | 레코드를 생성한 사용자/시스템 ID                    |
| 최종수정일시     | `last_modified_at`   | `TIMESTAMP WITH TIME ZONE`        | 레코드 최종 수정 시각                               |
| 최종수정자 ID    | `last_modified_by`   | `VARCHAR(50)` / `UUID`            | 레코드를 최종 수정한 사용자/시스템 ID               |
| (선택) 버전      | `version`            | `INTEGER`                         | 낙관적 잠금(Optimistic Locking) 등을 위한 버전 번호 |
| (선택) 삭제일시  | `deleted_at`         | `TIMESTAMP WITH TIME ZONE`        | (논리적 삭제 시) 레코드 삭제(비활성) 시각           |
| (선택) 삭제자 ID | `deleted_by`         | `VARCHAR(50)` / `UUID`            | (논리적 삭제 시) 레코드를 삭제한 사용자 ID          |

**구현 시 고려사항:**

- **자동화:** 대부분의 웹 프레임워크(예: Spring Data JPA)는 이러한 감사 필드를 어노테이션 등을 통해 자동으로 채워주는 기능을 제공합니다. 이를 활용하면 개발자가 직접 신경 쓰지 않아도 되어 편리합니다.
- **일관성:** 프로젝트 내 모든 테이블에 일관된 감사 필드명과 데이터 타입을 사용하는 것이 좋습니다.
- **사용자 식별:** `createdBy`, `lastModifiedBy` 필드에는 실제 사용자를 식별할 수 있는 ID(예: 로그인 ID, 사용자 테이블의 PK)를 저장하는 것이 일반적입니다. 시스템에 의한 자동 변경 시에는 'SYSTEM'과 같은 특정 값을 사용할 수 있습니다.
- **논리적 삭제 (Soft Delete):** 실제 데이터를 `DELETE`하는 대신 `deleted_at` 필드에 삭제 시각을 기록하고, `isActive`와 같은 상태 필드를 `false`로 변경하여 데이터를 보존하는 방식(논리적 삭제)을 사용하면, 감사 추적 및 데이터 복구가 용이해집니다.

QIRO 서비스의 데이터베이스를 설계할 때, 거의 모든 주요 엔티티 테이블에 이러한 감사 필드를 포함시키면 데이터 관리의 신뢰성과 안정성을 크게 높일 수 있습니다. 