# 📝 QIRO - 사업자 가입 및 인증 기능 명세서

## 1. 문서 정보

- **문서명:** QIRO - 사업자 가입 및 인증 기능 명세서
- **기능 ID:** F-SIGNUP-001 (Business Registration & Verification)
- **관련 요구사항 ID:** QIRO-FR-UM-001
- **작성일:** 2025년 07월 24일
- **문서 버전:** 1.0

## 2. 기능 개요

### 2.1. 목적

QIRO 서비스를 이용하고자 하는 신규 건물 관리 사업자가 사업자 정보의 정확성을 검증하고, 대표자의 신원을 확인함으로써 안전하고 신뢰할 수 있는 서비스 이용 환경을 구축한다. 이 기능을 통해 유효한 사업자만이 서비스를 이용할 수 있도록 필터링하고, 총괄 관리자 계정의 보안을 강화한다.

### 2.2. 설명

본 기능은 신규 사용자가 QIRO 서비스에 가입하는 전체 프로세스를 다룬다. 사용자는 5단계의 절차를 통해 가입을 완료하게 되며, 각 단계는 명확한 목적을 가진다.

1. **사업자 정보 입력:** 가입의 기초가 되는 사업자 정보를 입력한다.
2. **실시간 사업자 확인:** 국세청 API와 연동하여 입력된 정보의 진위를 실시간으로 확인한다.
3. **대표자 본인 인증:** 사업자등록증 상의 대표자 명의로 휴대폰 본인 인증을 수행하여 신원을 확인한다.
4. **비밀번호 설정:** 서비스 접속에 사용할 안전한 비밀번호를 설정한다.
5. **서비스 이용 시작:** 모든 인증 절차를 완료하고 서비스 대시보드로 진입한다.

### 2.3. 범위

- **In-Scope (포함 범위):**
  - 사업자 정보 입력 UI 및 데이터 처리.
  - 국세청 사업자등록상태조회 API 연동을 통한 사업자 정보 진위 확인.
  - 외부 본인인증 서비스(예: PG사 제공) 연동을 통한 대표자 휴대폰 본인 인증.
  - QIRO 서비스 계정(총괄 관리자) 생성을 위한 비밀번호 설정.
  - 단계별 가입 절차 UI 및 흐름 제어.
- **Out-of-Scope (제외 범위):**
  - 개인 사용자 또는 직원을 위한 가입 절차.
  - 결제 수단 등록 (가입 완료 후 별도 기능으로 제공).
  - 국세청 및 본인인증 서비스 자체의 구축.

## 3. 사용자 인터페이스(UI) 및 상호작용 (이미지 기반)

### 3.1. 전체 흐름 (5-Step Process)

```
사업자 정보 입력` → `실시간 사업자 확인` → `대표자 본인 인증` → `비밀번호 설정` → `서비스 이용 시작
```

### 3.2. 화면별 상세 설명

- **화면 1: 사업자 정보 입력 (`image_11fadb.jpg`)**
| UI 요소 | 유형 | 설명 | 유효성 규칙 |
| :--- | :--- | :--- | :--- |
| 사업자등록번호 | 입력 필드 | '-'를 제외한 10자리 숫자 입력 | 필수, 10자리 숫자 |
| 상호 (법인명) | 입력 필드 | 사업자등록증에 기재된 상호 입력 | 필수 |
| 대표자 성명 | 입력 필드 | 사업자등록증에 기재된 대표자 성명 입력 | 필수 |
| 개업일자 | 날짜 선택 | 사업자등록증에 기재된 개업일자 선택 | 필수, YYYY-MM-DD 형식 |
| 사업장 소재지 | 주소 검색 | 사업자등록증에 기재된 주소 입력 | 필수 |
| `[사업자 정보 제출]` | 버튼 | 입력된 정보로 다음 단계(진위 확인) 진행 | |
- **화면 2: 사업자 진위 확인 결과 (`image_11fe20.png`)**
| UI 요소 | 유형 | 설명 | | :--- | :--- | :--- |
| 확인 결과 요약 | 텍스트/아이콘 | 국세청 정보와 대조한 결과(유효성, 상태, 대표자 일치 여부)를 시각적으로 표시 |
| 불일치 안내 | 경고 메시지 | 정보가 불일치할 경우, 수정 또는 증빙 자료 제출을 안내하는 경고 메시지 표시 |
| `[정보 수정하기]` | 버튼 | 불일치 시, 이전 단계로 돌아가 정보 수정 |
| `[대표자 본인 인증]` | 버튼 | 모든 정보가 유효하고 일치할 경우, 다음 단계로 진행 |
- **화면 3: 대표자 본인 인증 (`image_11fe79.png`)**
| UI 요소 | 유형 | 설명 |
| :--- | :--- | :--- |
| 본인 인증 방법 선택 | 라디오 버튼 | '휴대폰 인증' 선택 |
| 통신사 선택 | 라디오 버튼 | SKT, KT, LGU+, 알뜰폰 |
| 휴대폰 번호 | 입력 필드 | 대표자 명의의 휴대폰 번호 입력 |
| `[인증번호 발송]` | 버튼 | 입력된 번호로 SMS 인증번호 발송 |
| 인증번호 | 입력 필드 | 수신한 인증번호 입력 |
| `[본인 인증 진행]` | 버튼 | 인증번호를 검증하여 본인 인증 완료 |
- **화면 4: 비밀번호 설정 (`image_11ff18.png`)**
| UI 요소 | 유형 | 설명 | 유효성 규칙 |
| :--- | :--- | :--- | :--- |
| 휴대폰 번호 | 텍스트 (읽기전용)| 본인 인증된 휴대폰 번호 표시 | |
| 비밀번호 | 입력 필드 (비밀번호) | 서비스 로그인에 사용할 비밀번호 입력 | 최소 8자 이상, 영문/숫자/특수문자 조합 등 보안 규칙 준수 |
| 비밀번호 확인 | 입력 필드 (비밀번호) | 비밀번호 재입력 | 위 비밀번호와 일치 |
| `[비밀번호 설정하기]`| 버튼 | 비밀번호를 최종 설정하고 가입 완료 | |
- **화면 5: 가입 완료 및 대시보드 (`image_12027a.png`)**
| UI 요소 | 유형 | 설명 |
| :--- | :--- | :--- |
| 가입 완료 안내 | 텍스트/아이콘 | "사업자 진위 확인이 완료되었습니다." 등 최종 안내 메시지 표시 |
| 서비스 시작 가이드 | 섹션/버튼 | 결제 수단 등록, 사용자 초대 등 초기 설정을 안내하고 관련 기능으로 연결 |

## 4. 처리 로직 및 비즈니스 규칙

- **R-SIGNUP-001 (사업자 진위 확인):** 사용자가 입력한 `사업자등록번호`, `대표자 성명`, `개업일자`를 국세청 사업자등록상태조회 API로 전송하여, 국세청에 등록된 정보와 일치하는지, 그리고 사업자 상태가 '계속사업자'인지 확인한다.
- **R-SIGNUP-002 (정보 불일치 처리):** 국세청 정보와 불일치하는 항목이 있을 경우, 사용자에게 불일치 내역을 명확히 안내하고 정보 수정을 유도한다. 정보 수정 후 재확인 절차를 거친다.
- **R-SIGNUP-003 (대표자 본인 인증):** 사업자 진위 확인이 완료되면, 입력된 '대표자 성명'과 외부 본인인증 서비스를 통해 인증된 명의가 일치하는지 확인한다.
- **R-SIGNUP-004 (계정 생성):** 대표자 본인 인증까지 완료되면, 입력된 사업자 정보를 바탕으로 시스템에 `Organization(조직)` 또는 `Company(회사)` 엔티티를 생성하고, 인증된 대표자 정보를 바탕으로 최상위 권한을 가진 `InternalUser(내부 사용자)` 계정(총괄 관리자)을 생성한다.
- **R-SIGNUP-005 (비밀번호 정책):** 비밀번호는 최소 8자 이상, 영문 대/소문자, 숫자, 특수문자 중 3가지 이상을 조합해야 하며, 안전한 해시 함수(예: Bcrypt)를 사용하여 저장한다.

## 5. 데이터 요구사항

- **입력 데이터:** 사업자등록번호, 상호, 대표자 성명, 개업일자, 사업장 주소, 대표자 휴대폰 번호, 비밀번호.
- **저장 데이터:**
  - **`Organization` (조직/회사):** 사업자등록번호, 회사명, 대표자명, 주소, 사업자 상태(인증 완료), 국세청 확인 일시 등.
  - **`InternalUser` (총괄 관리자):** 이름(대표자명), 연락처(인증된 휴대폰 번호), 이메일(가입 시 입력), 암호화된 비밀번호, 역할(`SUPER_ADMIN`) 등.

## 6. 외부 시스템 연동

- **국세청 사업자등록상태조회 서비스:** 사업자 정보의 진위를 확인하기 위해 API 연동이 필요하다.
- **본인인증 서비스 (예: 다날, KG모빌리언스 등 PG사 제공 서비스):** 대표자 명의의 휴대폰 본인 인증을 위해 API 연동이 필요하다.
- 