# 📝 QIRO - 임대 계약 관리 기능 명세서

### 1. 문서 정보
- **문서명:** QIRO - 임대 계약 관리 기능 명세서
- **기능 ID (선택 사항):** F-LCMGMT-001 (Lease Contract Management)
- **관련 요구사항 ID:** (예: QIRO-FR-LM-020, QIRO-FR-LM-021)
- **관련 사용자 스토리 ID:** (예: US-BM-XXX, US-SA-XXX)
- **작성일:** 2025년 06월 02일
- **최종 수정일:** 2025년 06월 02일
- **작성자:** QIRO 기획팀
- **검토자/승인자 (선택 사항):** (이름 또는 팀)
- **문서 버전:** 1.1 (목록 조회 UI 이미지 반영 및 전체 내용 통합)

### 2. 기능 개요
#### 2.1. 목적
QIRO 서비스 내에서 발생하는 모든 임대 계약의 생성부터 종료까지 전 과정을 체계적으로 등록, 조회, 수정, 관리할 수 있도록 한다. 이를 통해 계약 정보의 정확성을 유지하고, 계약 조건에 따른 임대료/관리비 청구, 계약 만료 관리, 공실 관리 등 임대 관리 업무 전반의 효율성을 증진시킨다.

#### 2.2. 설명
본 기능은 특정 건물/호실에 대해 임대인과 임차인 간의 임대 계약 정보를 상세하게 기록하고 관리하는 CRUD 기능을 제공한다. 계약 기간, 임대료, 보증금, 관리비 조건, 특약사항 등 계약의 주요 내용을 포함하며, 계약 상태(예정, 진행중, 만료 등)를 추적하고 관련 문서도 첨부할 수 있다. "임대 계약 목록 조회" 화면에서는 다양한 조건으로 계약을 검색하고, 만료 임박 계약 등을 쉽게 파악할 수 있다.

#### 2.3. 범위
- **In-Scope (포함 범위):**
    - 신규 임대 계약 등록 (임대인, 임차인, 임대물(호실) 연결).
    - 계약 조건 입력: 계약 기간(시작일, 종료일), 임대료(금액, 납부 주기, 납부일), 보증금, 관리비 조건, 중개 정보, 특약사항 등.
    - 계약 관련 문서 첨부 (예: 스캔된 계약서, 신분증 사본 등).
    - 임대 계약 목록 조회 (다양한 조건 검색: 건물, 호실, 임차인, 임대인, 계약 상태, 만료 예정일 등).
    - 임대 계약 상세 정보 조회 및 수정 (단, 주요 조건 변경 시 변경 이력 또는 부속 합의서 개념 필요).
    - 임대 계약 상태 관리 (예: `계약 예정`, `계약중`, `만료 예정`, `만료됨`, `해지됨`, `갱신됨`).
    - 계약 갱신 및 연장 처리 지원.
    - 계약 해지 처리 지원 (중도 해지, 만료 해지).
    - 계약 만료 예정 알림 목록 제공 (대시보드 연동 가능).
    - 계약 목록 내보내기 (Export) 기능.
    - (선택) 전자 계약 작성 기능 연동 또는 지원.
- **Out-of-Scope (제외 범위):**
    - 전자 계약 서비스 자체의 완전한 구현 (외부 서비스 연동 방식 우선 고려).
    - 임대료/관리비 실제 청구 및 수납 처리 (이는 '관리비 관리', '수납 처리' 기능과 연동되나, 해당 기능 자체는 아님).
    - 법률 자문 또는 계약서 자동 생성 기능.

### 3. 사용자 인터페이스 (UI) 및 상호작용
#### 3.1. 관련 화면
- `관리자 포털 > 임대 계약 관리` (또는 유사 경로)
    - **화면 제목:** 임대 계약 관리
    - **화면 부제목:** 임대 계약서 작성, 갱신, 종료 등 임대 계약 관련 기능을 제공합니다.

#### 3.2. UI 요소별 상세 설명 (예시)
- **화면 1: 임대 계약 목록 조회 화면** (사용자가 제공한 이미지 `image_aa9935.jpg` 참조)
    | UI 요소 ID (선택) | 요소명 (Label)                  | 유형 (Type)        | 기본값/표시 데이터                           | 동작 설명                                                    | 비고                                                    |
    | :---------------- | :------------------------------ | :----------------- | :------------------------------------------- | :----------------------------------------------------------- | :------------------------------------------------------ |
    | LC-LST-TOP-01     | **[+ 계약 등록]** 버튼          | 버튼               | -                                            | 클릭 시 '신규 임대 계약 등록 폼 화면'으로 이동               | 화면 우측 상단                                          |
    | LC-LST-TOP-02     | **[전자계약 작성]** 아이콘 버튼 | 아이콘 버튼        | -                                            | 클릭 시 전자 계약 작성 관련 기능 실행 (팝업 또는 새 페이지)  | (기능 구현 방식에 따라 상세 동작 정의 필요)             |
    | LC-LST-TOP-03     | **[내보내기]** 아이콘 버튼      | 아이콘 버튼        | -                                            | 클릭 시 현재 조회된 계약 목록을 파일(Excel, CSV 등) 형태로 다운로드 |                                                         |
    | LC-LST-NTF-01     | **계약 만료 임박 알림**         | 알림 영역 (텍스트) | -                                            | "현재 X건의 계약이 90일 이내에 만료될 예정입니다. 갱신 또는 종료 처리가 필요합니다." | 조건 충족 시 상단에 표시, 클릭 시 해당 계약 필터링 가능 |
    | LC-LST-FLT-TTL    | 필터 및 검색 제목               | 텍스트             | "필터 및 검색"                               |                                                              |                                                         |
    | LC-LST-FLT-SUB    | 필터 및 검색 부제목             | 텍스트             | "조회할 데이터를 필터링하세요"               |                                                              |                                                         |
    | LC-LST-FLT-01     | **계약 상태**                   | 드롭다운           | 전체                                         | 계약 상태(전체, 계약중, 만료 예정, 만료됨 등) 선택 필터      |                                                         |
    | LC-LST-FLT-02     | **세대/임차인/임대인 검색**     | 입력 필드          | "Q 세대 번호 또는 임차인 검색" (Placeholder) | 세대(동/호수), 임차인명, 임대인명 키워드 검색                |                                                         |
    | LC-LST-FLT-03     | **[필터 적용]** 버튼            | 버튼               | -                                            | 선택/입력된 필터 및 검색 조건으로 계약 목록을 다시 조회      |                                                         |
    | LC-LST-LST-TTL    | 임대 계약 목록 제목             | 텍스트             | "임대 계약 목록"                             |                                                              |                                                         |
    | LC-LST-LST-SUB    | 임대 계약 목록 부제목           | 텍스트             | "임대 계약 정보 및 상태입니다."              |                                                              |                                                         |
    | LC-LST-07         | **임대 계약 목록**              | 표                 | -                                            | 등록된 임대 계약 정보를 표 형태로 표시                       |                                                         |
    | (표 컬럼)         | **세대**                        | 텍스트             | (예: 1001)                                   | 계약된 호실 정보 (동/호수)                                   |                                                         |
    | (표 컬럼)         | **임차인**                      | 텍스트             | (예: 김철수)                                 | 임차인 명칭                                                  |                                                         |
    | (표 컬럼)         | **계약 시작일**                 | 날짜 (YYYY-MM-DD)  | (예: 2023-01-15)                             | 계약 효력 시작일                                             |                                                         |
    | (표 컬럼)         | **계약 종료일**                 | 날짜 (YYYY-MM-DD)  | (예: 2025-12-31)                             | 계약 효력 종료일                                             |                                                         |
    | (표 컬럼)         | **보증금**                      | 통화               | (예: 20,000,000원)                           | 계약 보증금액                                                |                                                         |
    | (표 컬럼)         | **월 임대료**                   | 통화               | (예: 2,500,000원)                            | 매월 납부하는 임대료                                         |                                                         |
    | (표 컬럼)         | **상태**                        | 텍스트 (배지 형태) | (예: 계약중)                                 | 현재 계약의 상태 (계약중, 만료 예정, 만료됨 등)              | 상태별 색상 구분 가능                                   |
    | (표 컬럼)         | **남은 기간**                   | 텍스트             | (예: 280일)                                  | 계약 종료일까지 남은 기간 (일 수 또는 개월 수). 만료 임박 시 강조 표시 (예: 빨간색 배경) |                                                         |
    | (표 컬럼)         | **관리**                        | 링크               | 상세                                         | 클릭 시 해당 계약의 상세 조회/수정 화면으로 이동             |                                                         |
    | LC-LST-BTM-01     | 조회 결과 건수                  | 텍스트             | (예: 총 10건의 계약이 조회되었습니다.)       | 현재 목록에 표시된 계약의 총 건수                            |                                                         |
    | LC-LST-08         | 페이지네이션                    | 페이지네이션       | 1                                            | 목록이 많을 경우 페이지 이동                                 |                                                         |

- **화면 2: 신규 임대 계약 등록 / 상세 조회 / 수정 폼 화면**
    * **탭 또는 섹션 구성:** 계약 기본 정보, 임대료/보증금 정보, 관리비 조건, 특약 사항, 첨부 파일, 변경 이력 등
    | UI 요소 ID (선택) | 요소명 (Label)                              | 유형 (Type)             | 예시/설명                                                    | 유효성 규칙/제약조건                                      |
    | :---------------- | :------------------------------------------ | :---------------------- | :----------------------------------------------------------- | :-------------------------------------------------------- |
    | LC-FRM-01         | 계약 대상 호실                              | 호실 선택 (검색/팝업)   | 시스템에 등록된 건물/동/호실 선택                            | 필수, '공실' 또는 '임대 가능' 상태인 호실 우선 표시       |
    | LC-FRM-02         | 임대인 정보                                 | 임대인 선택 (검색/팝업) | 등록된 임대인 정보 연결 (없을 시 신규 등록 바로가기)         | 필수                                                      |
    | LC-FRM-03         | 임차인 정보                                 | 임차인 선택 (검색/팝업) | 등록된 임차인 정보 연결 (없을 시 신규 등록 바로가기)         | 필수                                                      |
    | LC-FRM-04         | 계약일                                      | 날짜 선택               |                                                              | 필수                                                      |
    | LC-FRM-05         | 계약 시작일                                 | 날짜 선택               |                                                              | 필수, 계약일 이후                                         |
    | LC-FRM-06         | 계약 종료일                                 | 날짜 선택               |                                                              | 필수, 시작일 이후 (예: "2년 계약" 선택 시 자동 계산 옵션) |
    | LC-FRM-07         | 보증금                                      | 숫자 입력               | (단위: 원)                                                   | 필수, 숫자                                                |
    | LC-FRM-08         | 임대료(월세)                                | 숫자 입력               | (단위: 원)                                                   | 필수, 숫자                                                |
    | LC-FRM-09         | 임대료 납부 주기                            | 드롭다운                | 매월, 분기별 등                                              | 필수 (기본값 '매월')                                      |
    | LC-FRM-10         | 임대료 납부일 (매월)                        | 숫자/드롭다운           | 1~31일, 말일                                                 | 필수 (예: 매월 25일)                                      |
    | LC-FRM-11         | 관리비 조건                                 | 드롭다운/입력 필드      | 임대료 포함, 별도 실비 정산, 고정액 (금액 입력) 등           | 필수                                                      |
    | LC-FRM-12         | 중개사 정보 (선택)                          | 입력 필드               | 중개사무소명, 연락처                                         |                                                           |
    | LC-FRM-13         | 특약 사항                                   | 텍스트 영역             | 계약서상의 주요 특약 내용 입력                               |                                                           |
    | LC-FRM-14         | 계약서 등 첨부파일                          | 파일 업로드             | 스캔된 계약서, 관련 문서 등 (다중 파일 업로드 지원)          | 파일 형식/크기 제한                                       |
    | LC-FRM-15         | 계약 상태                                   | 드롭다운 (조건부)       | 계약 예정, 계약중, 만료 예정, 만료됨, 해지됨 (시스템이 조건에 따라 자동 변경 제안) |                                                           |
    | LC-FRM-16         | [저장], [수정], [갱신], [해지], [삭제] 버튼 | 버튼                    | (상황에 따라 활성화되는 버튼들)                              |                                                           |

#### 3.3. 주요 사용자 시나리오 (흐름)
- **시나리오 1: 신규 임대 계약 등록**
    1. 관리자가 '임대 계약 목록 조회 화면'에서 [+ 신규 계약 추가] 버튼을 클릭한다.
    2. '신규 임대 계약 등록 폼 화면'으로 이동한다.
    3. 관리자가 계약 대상 호실, 임대인, 임차인 정보를 시스템에서 검색하여 선택/연결한다. (정보가 없을 경우, 각 관리 기능으로 이동하여 신규 등록 후 다시 진행하거나, 폼 내 간편 등록 옵션 제공)
    4. 계약일, 계약 기간, 보증금, 임대료, 관리비 조건 등 주요 계약 내용을 입력한다.
    5. 필요한 경우 특약 사항을 기재하고 계약서 등 관련 파일을 첨부한다.
    6. 모든 정보 입력 후 [저장] 버튼을 클릭한다.
    7. 시스템은 유효성 검사 후 계약 정보를 저장하고, "임대 계약이 성공적으로 등록되었습니다." 메시지를 표시한다. 해당 호실의 상태는 '임대 예정' 또는 '임대중'으로 변경될 수 있다.
- **시나리오 2: 기존 계약 갱신 처리**
    1. 관리자가 '임대 계약 목록'에서 갱신할 계약(주로 '만료 예정' 상태)을 선택하여 상세 조회 화면으로 이동한다.
    2. [계약 갱신] 버튼을 클릭한다. (또는 유사한 액션)
    3. 시스템은 기존 계약 정보를 바탕으로 갱신 계약 입력 폼을 표시한다. (기존 정보 대부분 자동 채움)
    4. 관리자가 새로운 계약 기간, 변경된 임대료/보증금(해당 시) 등 갱신 조건을 수정 입력한다.
    5. [저장] 버튼을 클릭하여 갱신 계약 정보를 저장한다. 이전 계약의 상태는 '갱신됨(또는 만료됨)'으로, 새 계약은 '계약중(또는 계약 예정)'으로 처리된다.
- **시나리오 3: 계약 만료 예정 알림 확인 및 처리**
    1. 관리자가 대시보드 또는 '임대 계약 목록'의 알림 영역에서 계약 만료 예정(예: 90일 이내)인 계약 목록을 확인한다.
    2. 각 계약 건에 대해 임대인/임차인과 협의하여 갱신, 연장 또는 종료 절차를 진행한다.
    3. 협의 결과에 따라 시스템에서 해당 계약을 갱신 처리하거나, 종료(퇴거) 처리한다.

### 4. 데이터 요구사항
#### 4.1. 입력 데이터
- 계약 기본 정보: 계약일, 계약 기간(시작일, 종료일), 계약 상태
- 대상물 정보: 건물 ID, 동/호실 ID
- 당사자 정보: 임대인 ID, 임차인 ID
- 금전 조건: 보증금, 월 임대료, 납부 주기, 납부일
- 관리비 조건: 부담 주체, 금액 또는 방식
- 기타: 특약사항, 중개사 정보, 첨부 파일

#### 4.2. 출력 데이터 (화면 표시 및 보고서용)
- 임대 계약 목록 (검색/필터링 결과)
- 임대 계약 상세 정보
- 계약 만료 예정 목록
- (연계) 호실별 임대 현황 (공실률 보고서 기초 데이터)
- (연계) 임차인/임대인별 계약 이력

#### 4.3. 임대 계약 (LeaseContract) 엔티티 속성 (예시)
| 속성명 (Attribute)        | 데이터 타입 (Type)     | 필수       | 설명                                                         |
| :------------------------ | :--------------------- | :--------- | :----------------------------------------------------------- |
| `contractId`              | UUID / Long (PK)       | Y          | 계약 고유 ID                                                 |
| `unitId`                  | UUID / Long (FK)       | Y          | 임대 대상 호실 ID                                            |
| `lessorId`                | UUID / Long (FK)       | Y          | 임대인 ID                                                    |
| `tenantId`                | UUID / Long (FK)       | Y          | 임차인 ID                                                    |
| `contractNumber`          | String                 | N          | 계약 관리 번호 (시스템 자동 생성 또는 수기 입력)             |
| `contractDate`            | Date                   | Y          | 계약 체결일                                                  |
| `startDate`               | Date                   | Y          | 계약 시작일 (입주일과 다를 수 있음)                          |
| `endDate`                 | Date                   | Y          | 계약 종료일                                                  |
| `depositAmount`           | BigDecimal / Double    | Y          | 보증금                                                       |
| `rentAmount`              | BigDecimal / Double    | Y          | 월 임대료 (또는 해당 주기 임대료)                            |
| `rentPaymentCycle`        | Enum / String          | Y          | 임대료 납부 주기 (예: `MONTHLY`, `QUARTERLY`, `YEARLY_PREPAID`) |
| `rentPaymentDay`          | Integer / String       | Y          | 임대료 납부일 (예: 매월 25일, 말일은 'LAST_DAY' 등 코드화)   |
| `maintenanceFeeCondition` | String / Enum          | Y          | 관리비 조건 (예: `INCLUDED_IN_RENT`, `SEPARATE_BILLING`, `FIXED_AMOUNT`) |
| `maintenanceFeeAmount`    | BigDecimal / Double    | (조건부 Y) | 고정 관리비 금액 (조건이 `FIXED_AMOUNT`일 경우)              |
| `specialClauses`          | Text                   | N          | 특약 사항                                                    |
| `brokerInfo`              | String                 | N          | 중개사 정보                                                  |
| `status`                  | Enum / String          | Y          | 계약 상태 (예: `SCHEDULED`, `ACTIVE`, `EXPIRING_SOON`, `EXPIRED`, `TERMINATED`, `RENEWED`) |
| `parentContractId`        | UUID / Long (FK, Self) | N          | 갱신 계약의 경우 이전 계약 ID                                |
| `attachments`             | JSON / Array           | N          | 첨부 파일 정보 (파일명, S3 경로 등)                          |
| `createdAt`               | DateTime               | Y          | 생성 일시                                                    |
| `createdBy`               | String                 | Y          | 생성자 ID                                                    |
| `lastModifiedAt`          | DateTime               | Y          | 최종 수정 일시                                               |
| `lastModifiedBy`          | String                 | Y          | 최종 수정자 ID                                               |

### 5. 처리 로직 및 비즈니스 규칙
- **R-LCMGMT-001:** 특정 호실에 대해 계약 기간이 중첩되는 활성(`ACTIVE`, `SCHEDULED`, `EXPIRING_SOON`) 계약은 존재할 수 없다.
- **R-LCMGMT-002:** 계약 등록/갱신 시, 해당 호실의 상태는 '임대중(또는 임대 예정)'으로, 연결된 임차인의 상태는 '거주중(또는 입주 예정)'으로 업데이트될 수 있다.
- **R-LCMGMT-003:** 계약 종료일이 다가오면(예: 시스템 설정값 90일 전, 60일 전, 30일 전), 해당 계약의 상태는 자동으로 '만료 예정'으로 변경되고, 관리자에게 알림(화면 상단 알림 영역, 대시보드 등)을 제공한다.
- **R-LCMGMT-004:** 계약 해지 또는 만료 시, 해당 호실의 상태는 '공실'로, 임차인의 상태는 '퇴거 완료'로 변경하는 절차가 연동되어야 한다. ("이사 정산" 기능 호출)
- **R-LCMGMT-005:** 임대료, 보증금 등 금액 변경은 원칙적으로 계약 변경(부속 합의) 또는 갱신 계약을 통해 이루어져야 하며, 변경 이력이 관리되어야 한다 (별도 '계약 변경 이력' 기능 또는 엔티티 고려).
- **R-LCMGMT-006:** '남은 기간'은 계약 종료일과 현재 날짜를 기준으로 매일 자동으로 계산되어 표시된다. 특정 임계치(예: 30일) 이내일 경우 시각적으로 강조(예: 빨간색 배경)한다.
- **R-LCMGMT-007:** 사용자는 조회된 계약 목록을 지정된 파일 형식(Excel, CSV 등)으로 내보낼 수 있다. 내보내지는 데이터 필드는 목록에 표시된 주요 정보를 포함한다.

### 6. 오류 처리 및 예외 관리
| 오류 코드 (선택) | 발생 조건                             | 오류 메시지 (User-facing)                                |
| :--------------- | :------------------------------------ | :------------------------------------------------------- |
| E-LCMGMT-01      | 필수 입력 항목 누락                   | "[필드명]은(는) 필수 입력 항목입니다."                   |
| E-LCMGMT-02      | 계약 기간 오류 (종료일 < 시작일)      | "계약 종료일은 시작일 이후여야 합니다."                  |
| E-LCMGMT-03      | 이미 계약된 호실에 중복 계약 시도     | "해당 호실은 지정된 기간에 이미 다른 계약이 존재합니다." |
| E-LCMGMT-04      | 유효하지 않은 임대인/임차인/호실 정보 | "선택한 [임대인/임차인/호실] 정보가 유효하지 않습니다."  |

### 7. (기능별) 성능 요구사항
- P-LCMGMT-01: 임대 계약 목록 조회 시 (10,000건 기준, 복합 조건 검색) 3초 이내 응답.
- P-LCMGMT-02: 신규 계약 저장 시 1.5초 이내 처리 완료.
- P-LCMGMT-03: 계약 목록 내보내기(1,000건 기준) 시 10초 이내 파일 생성 및 다운로드 시작.

### 8. (기능별) 보안 요구사항
- S-LCMGMT-01: 임대 계약 관리 기능은 '총괄관리자', '관리소장', '경리담당자' 등 인가된 역할만 접근 가능하다. (역할별 수정/삭제 권한 차등 가능)
- S-LCMGMT-02: 계약서 등 중요 첨부 파일은 암호화하여 저장하고, 접근 권한을 엄격히 통제한다.
- S-LCMGMT-03: 계약 정보의 주요 변경(금액, 기간, 당사자 등) 이력은 감사 로그로 상세히 기록한다.

### 9. 다른 기능/모듈과의 연관성
- **임대인 관리 / 임차인 관리:** 계약 당사자인 임대인 및 임차인 정보를 직접 참조하고 연결한다.
- **건물/호실 정보 관리:** 임대 대상물인 호실 정보를 참조하고, 계약 상태에 따라 호실의 '공실/임대중' 상태에 영향을 준다.
- **관리비 관리 (부과, 고지, 수납) / 임대료 관리:** 계약서에 명시된 관리비 조건 및 임대료 정보를 바탕으로 월별 청구 대상 및 금액 산정의 기초가 된다.
- **알림/통지 서비스:** 계약 만료 예정 알림, 임대료 납부일 알림(선택) 등을 위해 본 기능의 데이터를 활용한다.
- **회계 관리:** 보증금 입금, 임대료 수입 등 계약 관련 금융 거래는 회계 처리와 연동될 수 있다.
- **이사 정산 관리:** 계약 종료 또는 해지 시, 본 계약 정보를 바탕으로 이사 정산 절차가 진행된다.

### 10. (선택 사항) 테스트 고려 사항
- 신규/갱신/연장/해지 등 다양한 계약 생애주기 시나리오 테스트.
- 다양한 계약 조건(납부 주기, 관리비 조건 등) 설정 및 정확성 검증.
- 계약 기간 중첩 방지 로직 테스트.
- 계약 상태 변경(자동/수동) 및 알림 기능 테스트.
- 첨부 파일 관리(업로드, 다운로드, 삭제) 기능 테스트.
- 계약 만료 임박 알림 정확성 및 관련 필터링 테스트.
- 목록 내보내기 기능의 데이터 정확성 및 파일 형식 테스트.

### 11. 용어 정의 (선택 사항)
- **임대 계약 (Lease Contract):** 임대인이 임차인에게 특정 자산(부동산)을 일정 기간 사용하게 하고, 임차인은 그 대가로 임대료를 지급하기로 약정하는 계약.
- **보증금 (Security Deposit):** 임대차 계약 시 임차인이 임대인에게 지급하는 담보금.
- **특약 사항 (Special Clauses/Riders):** 기본 계약 조건 외에 당사자 간 특별히 합의한 사항.
- **전자 계약 (Electronic Contract):** 서면 대신 전자적 형태로 체결되는 계약.

### 12. 문서 이력
| 버전 | 날짜             | 작성자      | 주요 변경 내용                                  |
| :--- | :--------------- | :---------- | :---------------------------------------------- |
| 1.0  | 2025년 06월 02일 | QIRO 기획팀 | 초기 명세서 안 작성                             |
| 1.1  | 2025년 06월 02일 | QIRO 기획팀 | 목록 조회 화면 UI 이미지 반영 및 전체 내용 통합 |