# **부과 대상과 계산 방식 조합**

### **1. 문서 개요**

본 문서는 건물관리 시스템에서 사용자가 선택하는 **'부과 대상(Target Scope)'**과 **'계산 방식(Calculation Method)'**의 모든 **논리적으로 유효한 조합**을 제시하고, 각 조합이 현실 세계에서 어떤 상황에 사용되는지에 대한 구체적인 적용 사례를 정리한 종합 가이드입니다. 시스템은 이 가이드에 따라 사용자의 선택지를 동적으로 제한해야 합니다.

### **2. '부과 대상' 중심의 적용 가능 계산 방식**

아래 표는 각 '부과 대상'의 성격에 따라, 시스템이 사용자에게 옵션으로 제공해야 할 '계산 방식'의 전체 목록을 정의합니다.

## **유형 1: 일반 그룹 (General Group)**

**여러 호실의 집합**을 대상으로, 공통의 비용을 배분하거나 동일한 규칙을 일괄 적용할 때 사용합니다.

- **해당 부과 대상:** `전체 호실`, `계약중인 호실`, `선택 호실`

| 적용 가능한 계산 방식                             | 현실 세계 적용 예시                                          |
| ------------------------------------------------- | ------------------------------------------------------------ |
| **`TOTAL_PER_AREA`** (총액 면적 비례 배분)        | • **(전체 호실)** 이번 달 건물 전체 화재보험료 총액 50만원을 계약면적 비율로 배분 • **(선택 호실)** A동 로비 리모델링 비용 300만원을 A동 호실들에게만 면적 비율로 배분 |
| **`TOTAL_PER_UNIT_EQUAL`** (총액 균등 배분)       | • **(계약중인 호실)** IPTV 단체 계약 요금 100만원을 입주 세대수로 균등하게 배분 • **(전체 호실)** 승강기 정기 점검비 20만원을 전체 호실 수로 균등하게 배분 |
| **`TOTAL_PER_SHARE_RATIO`** (총액 지분 비율 배분) | • **(선택 호실 - '상가 그룹')** 주상복합 건물의 상가 전용 에스컬레이터 전기료 30만원을, 사전에 정의된 상가별 지분율에 따라 배분 |
| **`RATE_PER_AREA`** (면적당 단가 배분)            | • **(전체 호실)** 관리 규약에 따라, 일반관리비를 계약면적 ㎡당 1,500원으로 책정하여 부과 • **(선택 호실 - '오피스 그룹')** 오피스 구역에만, 복도 냉난방비를 면적당 500원으로 책정하여 부과 |
| **`RATE_PER_VEHICLE`** (차량당 단가 배분)         | • **(계약중인 호실)** 입주민을 대상으로, 등록된 차량 1대당 월 3만원의 주차료를 부과 |
| **`FIXED_AMOUNT`** (고정액 부과)                  | • **(전체 호실)** 건물 전체 방역을 위해, 모든 호실에 월 3,000원의 고정 소독비를 부과 • **(선택 호실 - '창고 이용 그룹')** 별도 창고를 사용하는 호실 그룹에 월 5만원의 고정 이용료를 부과 |

## **유형 2: 공실 그룹 (Vacant Group)**

**비어있는 호실들만**을 대상으로 비용을 부과할 때 사용합니다. (청구는 소유주에게 전달됩니다)

- **해당 부과 대상:** `공실`

| 적용 가능한 계산 방식                                        | 현실 세계 적용 예시                                          |
| ------------------------------------------------------------ | ------------------------------------------------------------ |
| **`TOTAL_PER_AREA`** (총액 면적 비례 배분)                   | • 공실 세대들에게 부과되는 '공용 전기료' 총액을 각 공실의 면적 비율로 배분 |
| **`TOTAL_PER_UNIT_EQUAL`** (총액 균등 배분)                  | • 공실 세대들에게 부과되는 '기본 관리비' 총액을 공실 수로 균등하게 배분 |
| **`RATE_PER_AREA`** (면적당 단가 배분)                       | • 공실에 대해, 면적(㎡)당 500원의 '공실 관리비'를 책정하여 부과 |
| **`FIXED_AMOUNT`** (고정액 부과)                             | • 공실에 대해, 매월 2만원의 '최소 관리비'를 고정적으로 부과  |
| **※ 적용 불가 방식:** `RATE_PER_VEHICLE`, `RATE_PER_OCCUPANT`, `...USAGE` 계열 등. (공실에는 차량, 인원, 사용량이 없음) |                                                              |

## **유형 3: 이용자 그룹 (User Group)**

**특정 서비스나 자원을 '이용'하는 호실들만**을 대상으로 비용을 부과할 때 사용합니다.

- **해당 부과 대상:** 서비스 이용 호실, 계량기 사용 호실 등

| 적용 가능한 계산 방식                                       | 현실 세계 적용 예시                                          |
| ----------------------------------------------------------- | ------------------------------------------------------------ |
| **`RATE_PER_USAGE`** (사용량당 단가 배분)                   | • **(계량기 사용 호실)** 각 세대의 전기 계량기 검침값(kWh)에 사용량당 단가 120원을 곱하여 전기료 부과 |
| **`TIERED_RATE_PER_USAGE`** (구간별 요율 배분)              | • **(계량기 사용 호실)** 각 세대의 전기 사용량에 대해, 사용량 구간별로 다른 단가(누진세)를 적용하여 전기료 부과 |
| **`FIXED_AMOUNT`** (고정액 부과)                            | • **(서비스 이용 호실)** 헬스장 이용을 신청한 세대에게 매월 고정액 3만원을 부과 |
| **`INDIVIDUAL_USAGE_PROPORTIONAL`** (사용량 비례 총액 배분) | • **(계량기 사용 호실)** 단지 전체에 부과된 '지역난방비' 총액 5,000만원을, 각 세대의 난방 사용량(열량계) 비율에 따라 배분 |

## **유형 4: 개별 지정 호실 (Individual Unit)**

**단일 호실에 대한 일회성** 또는 **여러 호실에 대한 '각기 다른' 일회성** 비용을 부과해야 할 때 사용합니다.

- **해당 부과 대상:** 관리자가 월별 부과 시 직접 지정하는 특정 호실

| 적용 가능한 계산 방식                    | 현실 세계 적용 예시                                          |
| ---------------------------------------- | ------------------------------------------------------------ |
| **`DIRECT_ASSIGNMENT`** (직접 지정 부과) | • 205호의 과실로 파손된 공용 시설물 수리비 25만원을 205호에 직접 부과  • 이번에 진행한 복도 보수 공사 비용을, 기여도에 따라 301호에는 5만원, 302호에는 7만원, 303호에는 4만원을 각각 부과 |





---





# **'계산 방식' 선택에 따른 상세 조건 UI 명세**

### **1. 문서 개요**

본 문서는 '청구 항목 설정' 화면에서 사용자가 특정 **'계산 방식(Calculation Method)'**을 선택했을 때, 시스템이 해당 방식의 완성을 위해 사용자에게 제시해야 할 **다음 단계의 UI 요소**를 명확하게 정의합니다. 이 가이드는 동적 폼(Dynamic Form)의 구체적인 동작 로직을 설계하기 위한 최종 기준입니다.

### **2. 계산 방식별 다음 UI 요소**

아래 표는 각 `계산 방식`에 따라, 사용자에게 표시되어야 할 다음 UI 요소를 상세하게 정의합니다.

#### **그룹 1: 총액 기반 배분 (Total Amount-based Allocation)**

| 사용자가 선택한 계산 방식                                   | 다음에 표시되는 UI 요소(들)                                  | 설명                                                         |
| ----------------------------------------------------------- | ------------------------------------------------------------ | ------------------------------------------------------------ |
| **`TOTAL_PER_AREA`** (총액 면적 비례 배분)                  | **[드롭다운] 배분 기준 면적** • 옵션: `전용면적`, `공급면적`, `계약면적` | 그룹에 부과될 총액을 어떤 면적 기준으로 나눌지 선택합니다.   |
| **`TOTAL_PER_UNIT_EQUAL`** (총액 균등 배분)                 | **(추가 UI 없음)**                                           | 추가적인 조건 없이, 그룹 내 호실 수로 균등하게 배분됩니다.   |
| **`TOTAL_PER_SHARE_RATIO`** (총액 지분 비율 배분)           | **[검색/선택] 배분 그룹** • 동작: 사전에 정의된 '배분 그룹'(예: 상가 그룹) 목록을 보여주는 UI | 이 비용을 배분할 대상이 되는, 지분율이 설정된 특정 그룹을 선택합니다. |
| **`INDIVIDUAL_USAGE_PROPORTIONAL`** (사용량 비례 총액 배분) | **(추가 UI 없음)**                                           | 총액과 각 세대 사용량은 월별로 별도 입력받으므로, 이 설정 화면에서는 추가 조건이 필요 없습니다. |

#### **그룹 2: 단가 기반 배분 (Unit Rate-based Allocation)**

| 사용자가 선택한 계산 방식                      | 다음에 표시되는 UI 요소(들)                                  | 설명                                                         |
| ---------------------------------------------- | ------------------------------------------------------------ | ------------------------------------------------------------ |
| **`RATE_PER_AREA`** (면적당 단가 배분)         | **[숫자 입력] 면적당 단가(원)** **[드롭다운] 기준 면적** • 옵션: `전용면적`, `공급면적`, `계약면적` | 각 호실의 어떤 면적에, 얼마의 단가를 곱할지 설정합니다.      |
| **`RATE_PER_USAGE`** (사용량당 단가 배분)      | **[숫자 입력] 사용량당 단가(원)**                            | 각 이용자의 실제 사용량(계량기 값 등)에 곱해질 단가를 설정합니다. |
| **`TIERED_RATE_PER_USAGE`** (구간별 요율 배분) | **[구간 설정 UI]** • 동작: 사용량 구간(시작, 끝)과 해당 구간의 단가를 여러 개 추가/수정/삭제할 수 있는 인터페이스 | 누진세 등 복잡한 요금제를 시스템에 등록합니다.               |
| **`RATE_PER_VEHICLE`** (차량당 단가 배분)      | **[숫자 입력] 차량당 단가(원)**                              | 그룹 내 각 호실의 등록 차량 1대당 부과될 단가를 설정합니다.  |
| **`RATE_PER_OCCUPANT`** (인원당 단가 배분)     | **[숫자 입력] 인원당 단가(원)**                              | 그룹 내 각 호실의 거주 인원 1명당 부과될 단가를 설정합니다.  |

#### **그룹 3: 고정액 및 직접 지정 (Fixed Amount & Direct Assignment)**

| 사용자가 선택한 계산 방식                | 다음에 표시되는 UI 요소(들)            | 설명                                                         |
| ---------------------------------------- | -------------------------------------- | ------------------------------------------------------------ |
| **`FIXED_AMOUNT`** (고정액 부과)         | **[숫자 입력] 호실별 고정 부과액(원)** | 그룹 내 모든 호실 또는 특정 서비스 이용자에게 동일하게 부과될 고정 금액을 설정합니다. |
| **`DIRECT_ASSIGNMENT`** (직접 지정 부과) | **(추가 UI 없음)**                     | 실제 부과 금액은 '일회성 비용 부과' 화면에서 관리자가 직접 입력하므로, 이 설정 화면에서는 추가 조건이 필요 없습니다. |





# **계산 방식별 상세 시나리오 가이드**



## **그룹 1: 총액 기반 배분 (Total Amount-based Allocation)**

**"하나의 고지서를 공평하게 나누는"** 방식입니다. 매월 금액이 변동하는 비용 총액이 발생했을 때 사용합니다.

### `TOTAL_PER_AREA` (총액 면적 비례 배분)

- **이럴 때 사용하세요!**

  > 매월 금액이 달라지는 **공용관리비 총액**을, 가장 합리적인 기준인 **면적**에 따라 모든 세대에 나누어 부과하고 싶을 때.

- **구체적인 시나리오:**

  - **상황:** 5월 한 달간 건물 전체의 청소 용역비로 **100만원**의 세금계산서가 발행되었습니다.
  - **설정:** '청소비' 항목의 계산 방식을 `TOTAL_PER_AREA`로, 배분 기준 면적을 '계약면적'으로 설정합니다.
  - **업무:** 관리자는 '월별 총액 입력' 화면에서 '청소비' 항목의 5월 총액으로 100만원을 입력합니다.
  - **결과:** 시스템은 건물 전체 계약면적 합계 대비 각 호실의 계약면적 비율을 자동으로 계산하여 100만원을 배분합니다. (예: 전체 면적의 5%를 차지하는 101호는 5만원 부담)

### `TOTAL_PER_UNIT_EQUAL` (총액 세대별 균등 배분)

- **이럴 때 사용하세요!**

  > 비용의 혜택이 모든 세대에 **면적과 무관하게 동일**하다고 판단될 때, 총액을 세대수로 똑같이 나누고 싶을 때.

- **구체적인 시나리오:**

  - **상황:** 건물 전체의 케이블TV 단체 계약 요금으로 **50만원**이 청구되었습니다.
  - **설정:** 'TV 수신료' 항목의 계산 방식을 `TOTAL_PER_UNIT_EQUAL`로 설정합니다.
  - **업무:** 관리자는 월별 총액으로 50만원을 입력합니다.
  - **결과:** TV 시청은 호실 크기와 상관없으므로, 전체 50세대에 동일하게 1만원씩 부과됩니다.

### `TOTAL_PER_SHARE_RATIO` (총액 지분 비율 배분)

- **이럴 때 사용하세요!**

  > 비용 총액을 **전체 세대 또는 특정 그룹에게**, 면적이 아닌 **특별한 비율(%)**로 나눠야 할 때.

- **구체적인 시나리오:**

  - **상황:** 주상복합 건물의 1층 상가 구역에서만 사용하는 에스컬레이터 전기료 **30만원**이 나왔습니다.
  - **설정:**
    1. **(사전작업)** '배분 그룹 관리' 메뉴에서 '상가 그룹'을 만들고, 각 상가 호실의 비용 부담 지분율(A상가 50%, B상가 50%)을 등록합니다.
    2. '상가 에스컬레이터 전기료' 항목의 계산 방식을 `TOTAL_PER_SHARE_RATIO`로, 배분 그룹을 '상가 그룹'으로 지정합니다.
  - **업무:** 관리자는 월별 총액으로 30만원을 입력합니다.
  - **결과:** 30만원은 오직 '상가 그룹'에만, A상가 15만원, B상가 15만원으로 배분됩니다. 주거 세대에는 부과되지 않습니다.

## **그룹 2: 단가 기반 배분 (Unit Rate-based Allocation)**

**"메뉴판 가격대로 계산하는"** 방식입니다. 미리 정해진 단가에 각자 사용한 수량을 곱합니다.

### `RATE_PER_USAGE` (사용량당 단가 배분)

- **이럴 때 사용하세요!**

  > 전기, 수도, 가스처럼 각 세대(호실)별로 **계량기**가 있고, 사용량 1단위당 **단가**가 명확하게 정해져 있을 때.

- **구체적인 시나리오:**

  - **상황:** 세대 전기료를 부과해야 합니다.
  - **설정:** '세대 전기료' 항목의 계산 방식을 `RATE_PER_USAGE`로, 사용량당 단가를 '120원/kWh'로 설정합니다.
  - **업무:** 관리자는 매월 각 세대의 계량기 검침값(사용량)을 시스템에 입력합니다. (예: 101호 200kWh, 102호 250kWh)
  - **결과:** 101호는 24,000원(`120×200`), 102호는 30,000원(`120×250`)이 자동으로 계산되어 부과됩니다.



## **시나리오 1: 여러 호실에 동일한 "고정 금액"을 한 번만 부과할 때**

- **상황 예시:** "이번 달 커뮤니티 행사 준비비로, 101호, 102호, 201호, 205호에게만 각각 1만원씩 부과해야 합니다."
- **적용 조합:**
  - **부과 대상 (`target_scope`):** **`CUSTOM_UNITS` (선택 호실)**
  - **계산 방식 (`allocation_method`):** **`FIXED_AMOUNT` (고정액 부과)**
- **시스템 처리 흐름:**
  1. 관리자는 **'일회성 비용 부과'** 화면으로 이동합니다.
  2. '부과 대상'으로 **'선택 호실'**을 고릅니다.
  3. **[호실 선택]** 버튼을 눌러 101, 102, 201, 205호를 직접 체크합니다.
  4. '계산 방식'으로 **'고정액 부과'**를 선택합니다.
  5. 화면에 나타나는 **'호실별 고정 부과액'** 입력 필드에 '10,000'원을 입력합니다.
  6. 부과를 확정하면, 시스템은 선택된 4개 호실에만 이번 달 관리비에 10,000원을 추가합니다.

## **시나리오 2: 여러 호실에 "각기 다른 금액"을 한 번만 부과할 때**

- **상황 예시:** "이번에 진행한 복도 보수 공사 비용을, 기여도에 따라 301호에는 5만원, 302호에는 7만원, 303호에는 4만원을 각각 부과해야 합니다."
- **적용 조합:**
  - **부과 대상 (`target_scope`):** **`CUSTOM_UNITS` (선택 호실)**
  - **계산 방식 (`allocation_method`):** **`DIRECT_ASSIGNMENT` (직접 지정 부과)**
- **시스템 처리 흐름:**
  1. 관리자는 **'일회성 비용 부과'** 화면으로 이동합니다.
  2. '부과 대상'으로 **'선택 호실'**을 고릅니다.
  3. **[호실 선택]** 버튼을 눌러 301, 302, 303호를 체크합니다.
  4. '계산 방식'으로 **'직접 지정 부과'**를 선택합니다.
  5. 시스템은 선택된 호실 목록과 함께 **각 호실별로 금액을 입력할 수 있는 표(Grid)**를 화면에 표시합니다. | 호실 번호 | 부과 금액 (원) | | :--- | :--- | | 301호 | `[ 50,000 ]` | | 302호 | `[ 70,000 ]` | | 303호 | `[ 40,000 ]` |
  6. 관리자가 각 금액을 입력하고 부과를 확정하면, 시스템은 해당 호실에 각각 다른 금액을 이번 달 관리비에 추가합니다.

