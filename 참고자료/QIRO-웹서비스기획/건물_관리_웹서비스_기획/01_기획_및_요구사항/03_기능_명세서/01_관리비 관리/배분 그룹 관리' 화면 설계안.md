# **'배분 그룹 관리' 화면 설계안**

### **1. 문서 개요**

본 문서는 `TOTAL_COMMON_PER_SHARE_RATIO`(총액 지분 비율 배분) 계산 방식을 사용하기 위해, 특정 비용을 나눠 낼 **호실 그룹과 각 호실의 지분율(%)을 사전에 정의**하고 관리하는 **'배분 그룹 관리'** 화면의 상세 설계안입니다.

### **2. 화면 설계 및 구성요소**

화면은 크게 **'배분 그룹 목록'** 영역과 선택된 그룹의 **'상세 설정'** 영역으로 구성된 2단 구조로 설계합니다.

**[좌측 또는 상단]**

#### **배분 그룹 목록 영역**

| UI 요소                     | 설명                                                         |
| --------------------------- | ------------------------------------------------------------ |
| **`[그룹 목록]`**           | 현재 건물에 등록된 모든 배분 그룹의 목록이 표시됩니다. (예: "상가 그룹", "주거 그룹", "A동 상가 그룹") |
| **`[+ 새 그룹 추가]` 버튼** | 새로운 배분 그룹을 생성하는 폼을 활성화합니다.               |
| **`[수정]`, `[삭제]` 버튼** | 목록에서 선택한 그룹을 수정하거나 삭제합니다.                |

**[우측 또는 하단]**

#### **그룹 상세 설정 영역**

*`좌측 목록에서 '상가 그룹'을 선택했다고 가정한 화면입니다.`*

**그룹 기본 정보**
| UI 요소 | 입력 방식 | 설명 |
| :--- | :--- | :--- |
| **그룹명** | 텍스트 입력 | 그룹의 이름을 입력하거나 수정합니다. (예: 상가 그룹) |
| **설명** | 텍스트 입력 | 해당 그룹에 대한 설명을 기입합니다. (예: 1~3층 상가 전용 시설 비용 배분을 위한 그룹) |

**그룹 멤버 및 지분율 설정 (핵심 기능)** 

| | |
| :--- | :--- |
| **총 멤버 수:** 3 세대 | `[+ 호실 추가]` 버튼 |

| 호실 번호 | 임차인/소유주 | **지분율 (%)** | 관리          |
| --------- | ------------- | -------------- | ------------- |
| 101호     | 스타벅스      | **`[ 50.0 ]`** | `[삭제]` 버튼 |
| 102호     | 올리브영      | **`[ 25.0 ]`** | `[삭제]` 버튼 |
| 201호     | 제일정형외과  | **`[ 25.0 ]`** | `[삭제]` 버튼 |
|           | **합계**      | **100.0 %**    |               |

- **지분율 (%) 입력:** 각 호실 옆에 있는 입력칸에 해당 호실이 부담할 비용의 비율을 직접 입력합니다.
- **합계 자동 계산:** 시스템은 입력된 지분율의 합계를 실시간으로 계산하여 보여주고, **합계가 100%가 아닐 경우 경고 메시지(예: "합계가 100%가 되어야 합니다.")를 표시**하여 사용자의 실수를 방지합니다.

### **3. 핵심 동작 흐름 (User Flow)**

1. **사전 작업 (그룹 생성):** 관리자는 먼저 **'배분 그룹 관리'** 화면으로 이동하여 `[+ 새 그룹 추가]` 버튼을 눌러 '상가 그룹'을 만듭니다.
2. **멤버 추가:** `[+ 호실 추가]` 버튼을 눌러 팝업에서 이 그룹에 포함시킬 상가 호실들(101, 102, 201호)을 선택하여 추가합니다.
3. **지분율 입력:** 추가된 각 호실의 '지분율 (%)' 입력칸에 계약서 등에 명시된 비용 부담 비율을 입력하고, 합계가 100%가 되는 것을 확인한 후 저장합니다.
4. **청구 항목 설정에서 사용:** 이후 '정기 관리비 항목 설정' 화면에서 계산 방식으로 `TOTAL_COMMON_PER_SHARE_RATIO`를 선택하면, **'배분 그룹 선택' 드롭다운 메뉴에 위에서 만든 "상가 그룹"이 옵션으로 표시**됩니다. 관리자는 이것을 선택하기만 하면 모든 설정이 완료됩니다.

### **4. 시스템 연동 방식**

- **데이터 관리:** 이 기능은 두 개의 핵심 테이블로 관리하는 것이 이상적입니다.
  1. **`ALLOCATION_GROUPS`:** 그룹의 기본 정보(group_id, group_name 등)를 저장합니다.
  2. **`ALLOCATION_GROUP_UNITS`:** 어떤 그룹에 어떤 호실이 포함되고, 각 호실의 지분율은 몇 %인지를 저장합니다. (group_id, unit_id, share_ratio)