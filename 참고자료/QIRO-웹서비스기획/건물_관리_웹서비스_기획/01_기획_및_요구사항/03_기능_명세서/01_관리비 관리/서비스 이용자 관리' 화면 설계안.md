# **'서비스 이용자 관리' 화면 설계안**

### **1. 문서 개요**

본 문서는 건물관리 시스템에서 `FIXED_AMOUNT`(고정액 부과) 또는 `RATE_PER_...`(수량 기반 단가) 방식으로 운영되는 특정 서비스(예: 헬스장, 월 주차료 등)에 대해, **어떤 호실이 해당 서비스를 이용하고 있는지를 관리**하는 **'서비스 이용자 관리'** 화면의 상세 설계안입니다.

### **2. 화면 설계 및 구성요소**

화면은 크게 **'서비스 선택'** 영역과 선택된 서비스의 **'이용자 관리'** 영역으로 구성된 2단 구조로 설계합니다.

#### **[상단] 서비스 선택 영역**

| UI 요소                           | 설명                                                         |
| --------------------------------- | ------------------------------------------------------------ |
| **`[드롭다운 메뉴]` 서비스 선택** | 관리할 서비스를 선택합니다. 이 목록에는 **'정기 관리비 항목 설정'에서 생성된 `개별비` 유형의 항목**만 표시됩니다. (예: 헬스장 이용료, 세대 창고 이용료, 월 주차료) |

#### **[하단] 이용자 상세 관리 영역**

*`상단의 서비스 선택 드롭다운에서 '헬스장 이용료'를 선택했다고 가정한 화면입니다.`*

**서비스 정보**

> **헬스장 이용료**
>
> **계산 방식:** 고정액 부과
>
> **부과 금액:** 30,000 원/월

**이용 호실 관리**
| | |
| :--- | :--- |
| **총 이용 세대:** 3 세대 | `[+ 이용 호실 추가]` 버튼 |

**이용자 목록**
| 호실 번호 | 임차인/소유주 | 신청일 | 관리 |
| :--- | :--- | :--- | :--- |
| 101호 | 홍길동 | 2025-05-01 | `[이용 중지]` 버튼 |
| 205호 | 김철수 | 2025-05-15 | `[이용 중지]` 버튼 |
| 301호 | 이영희 | 2025-06-01 | `[이용 중지]` 버튼 |

### **3. 핵심 동작 흐름 (User Flow)**

#### **가. 새로운 이용 호실 추가하기**

1. 관리자가 상단의 **[서비스 선택]** 드롭다운에서 '헬스장 이용료'를 선택합니다.
2. **[+ 이용 호실 추가]** 버튼을 클릭합니다.
3. **[이용 호실 추가 팝업]** 창이 나타납니다.
   - 팝업 창에는 건물의 전체 호실 목록이 체크박스와 함께 표시됩니다.
   - 단, 이미 '헬스장 이용료'를 이용 중인 호실(101, 205, 301호)은 비활성화 처리되어 중복 선택이 불가능합니다.
4. 관리자가 새로 이용을 신청한 **'302호', '405호'**를 체크하고 **[추가]** 버튼을 클릭합니다.
5. 팝업 창이 닫히고, 하단의 '이용자 목록'에 302호와 405호가 즉시 추가되어 총 5세대로 표시됩니다.

#### **나. 기존 이용 호실 중지하기**

1. 관리자가 '이용자 목록'에서 **'205호'** 옆에 있는 **[이용 중지]** 버튼을 클릭합니다.
2. **[확인 팝업]** 창이 나타납니다.
   - "205호의 '헬스장 이용료' 이용을 중지하시겠습니까? 이용 중지 시, 다음 달 관리비부터 해당 항목이 부과되지 않습니다."
3. 관리자가 **[확인]** 버튼을 클릭합니다.
4. '이용자 목록'에서 205호가 즉시 사라지고, '총 이용 세대'는 4세대로 변경됩니다.

### **4. 시스템 연동 방식**

- **월별 관리비 자동 계산 시:** 시스템은 '헬스장 이용료' 항목을 계산할 때, 이 화면의 **'이용자 목록'에 등록된 호실들에게만** 사전에 설정된 고정 금액(30,000원)을 부과합니다.
- **데이터 관리:** 이 화면의 데이터는 별도의 **`SERVICE_SUBSCRIBERS`** 와 같은 테이블에서 `(building_id, billing_item_config_id, unit_id)` 조합으로 관리되어야 합니다.