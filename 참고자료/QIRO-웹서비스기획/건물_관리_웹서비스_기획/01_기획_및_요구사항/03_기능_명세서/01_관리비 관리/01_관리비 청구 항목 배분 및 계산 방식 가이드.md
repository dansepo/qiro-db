# **관리비 청구 항목 배분 및 계산 방식 가이드**

### **1. 문서 개요**

본 문서는 건물관리 시스템에서 사용하는 다양한 청구 항목들이 **누구에게(부과 대상), 어떤 계산 방식에 따라** 각 세대(입주사)에 배분되는지를 정의합니다. 이 가이드는 관리비 부과의 자동화, 형평성, 투명성을 확보하기 위한 시스템 설계의 핵심 명세입니다.

### **2. 배분 방식의 두 가지 핵심 요소**

모든 관리비 부과는 다음 두 가지 요소의 조합으로 이루어집니다.

1. **부과 대상 (Target Scope):** 비용을 부과할 대상 그룹입니다. (예: 전체 호실, 상가 그룹, 특정 호실)
2. **계산 방식 (Calculation Method):** 지정된 청구 대상 그룹 내에서 각 세대의 부담액을 산출하는 구체적인 공식입니다.

### **3. 부과 대상 지정 (Target Scope Selection)**

가장 먼저 이 청구 항목을 부과할 대상 호실 그룹의 성격을 선택합니다.

| 부과 대상 선택 옵션 | 동적 UI 동작 및 설명                                         | 저장되는 데이터 (`target_scope`)                             |
| ------------------- | ------------------------------------------------------------ | ------------------------------------------------------------ |
| **전체 호실**       | 추가 UI 없음. 건물에 등록된 모든 호실을 대상으로 합니다.     | `ALL_UNITS`                                                  |
| **계약중인 호실**   | 추가 UI 없음. 시스템이 계약 상태를 실시간으로 판단하여, 현재 임차인이 있는 '계약중' 상태의 호실만 자동으로 필터링합니다. | `OCCUPIED_UNITS`                                             |
| **공실**            | 추가 UI 없음. 시스템이 계약 상태를 실시간으로 판단하여, 현재 비어있는 '공실' 상태의 호실만 자동으로 필터링합니다. | `VACANT_UNITS`                                               |
| **선택 호실**       | **[호실 선택] 버튼**이 활성화됩니다. • **동작:** 클릭 시 전체 호실 목록을 체크박스 형태로 보여주고, 사용자가 이 비용을 배분할 대상 호실들을 **직접 선택**하는 팝업(Modal) 창이 열립니다. | **`CUSTOM_UNITS`** (선택된 호실 ID 목록은 별도 테이블 또는 컬럼에 저장) |

### **4. 계산 방식 상세 정의 (Calculation Methods)**

시스템에서 사용되는 계산 방식은 크게 **총액 기반, 단가 기반, 고정액/직접 지정** 세 가지 그룹으로 나눌 수 있습니다.

#### **그룹 1: 총액 기반 배분 (Total Amount-based Allocation)**

**월별로 발생한 비용 총액**을 정해진 기준에 따라 대상 그룹에 배분하는 방식입니다.

| 계산 방식 코드 (Enum)               | 방식명                    | 계산 로직 (Formula)                                    | 주요 사용 항목                     |
| ----------------------------------- | ------------------------- | ------------------------------------------------------ | ---------------------------------- |
| **`TOTAL_COMMON_PER_AREA`**         | **총액 면적 비례 배분**   | `(월별 총액 / 그룹의 전체 면적 합계) × 해당 세대 면적` | 일반관리비, 청소비 등              |
| **`TOTAL_COMMON_PER_UNIT_EQUAL`**   | **총액 세대별 균등 배분** | `월별 총액 / 그룹 내 전체 세대수`                      | TV 수신료, 인터넷 공용요금 등      |
| **`TOTAL_COMMON_PER_SHARE_RATIO`**  | **총액 지분 비율 배분**   | `월별 총액 × 해당 세대의 지분율(%)`                    | 상가 전용 시설비 등 특정 그룹 비용 |
| **`INDIVIDUAL_USAGE_PROPORTIONAL`** | **사용량 비례 총액 배분** | `월별 총액 × (해당 세대 사용량 / 그룹 내 전체 사용량)` | 지역난방비 등                      |

#### **그룹 2: 단가 기반 배분 (Unit Rate-based Allocation)**

**산출된 단가 또는 미리 정의된 단가**에 각 세대의 특정 **수량(면적, 사용량 등)**을 곱하여 금액을 산출하는 방식입니다.

- 어떤 `배분 방식 코드`를 선택했느냐에 따라 시스템이 단위를 암시적으로 판단해야 합니다.

| 계산 방식 코드 (Enum)       | 방식명                        | 계산 로직 (Formula)                               | 주요 사용 항목             |
| --------------------------- | ----------------------------- | ------------------------------------------------- | -------------------------- |
| **`RATE_PER_AREA`**         | **면적당 단가 배분**          | `면적당 단가 × 해당 세대 면적`                    | (특정 계약) 상가 임대료 등 |
| **`RATE_PER_USAGE`**        | **사용량당 단가 배분**        | `사용량당 단가 × 해당 세대 사용량(계량기 검침값)` | 세대 전기/수도/가스 요금   |
| **`TIERED_RATE_PER_USAGE`** | **구간별 요율 배분 (누진세)** | `사용량 구간별로 설정된 단가를 적용하여 계산`     | 누진세 방식의 세대 전기료  |
| **`RATE_PER_VEHICLE`**      | **차량당 단가 배분**          | `차량당 단가 × 해당 세대 등록 차량 수`            | 월 주차료                  |
| **`RATE_PER_OCCUPANT`**     | **인원당 단가 배분**          | `인원당 단가 × 해당 세대 등록 인원수`             | 커뮤니티 인당 이용료 등    |

#### **그룹 3: 고정액 및 직접 지정 (Fixed Amount & Direct Assignment)**

미리 정해진 금액을 부과하거나, 관리자가 직접 금액을 입력하여 부과하는 방식입니다.

| 계산 방식 코드 (Enum)   | 방식명             | 계산 로직 (Formula)                      | 주요 사용 항목                                               |
| ----------------------- | ------------------ | ---------------------------------------- | ------------------------------------------------------------ |
| **`FIXED_AMOUNT`**      | **고정액 부과**    | `항목에 설정된 고정 금액`                | 헬스장 월 이용료 등 정기적, 반복적 부과 (구독료 개념) 미리 청구 항목을 설정하는 화면에서 고정 금액을 정의 |
| **`DIRECT_ASSIGNMENT`** | **직접 지정 부과** | `관리자가 월별 부과 시 직접 입력한 금액` | 주차 위반금, 카드키 재발급비 등 비정기적, 일회성 부과 (벌금, 실비 정산 개념) 매월 관리비 부과 시점에 관리자가 금액을 직접 입력 |

### **4. 시스템 구현 제안**

- **청구 항목 설정:** 관리자는 청구 항목을 설정할 때, **'부과 대상'**을 먼저 지정하고, 이어서 위 표에 정의된 **'계산 방식'** 중 하나를 선택해야 합니다.
- **동적 폼:** 시스템은 선택된 '계산 방식'에 따라 필요한 추가 정보(예: 면적 종류, 단가, 고정 금액)를 입력받는 UI를 동적으로 제공해야 합니다.
- **배분 엔진:** 월별 관리비 계산 시, 시스템의 배분 엔진은 각 청구 항목에 설정된 **'부과 대상'을 필터링**한 후, 해당 대상 그룹 내에서 **'계산 방식'에 정의된 공식에 따라** 각 세대의 부과 금액을 자동으로 산출합니다.



### **참고: 면적의 종류와 적용 기준**

관리비 배분의 가장 중요한 기준인 면적은 다음과 같이 구분되며, 항목별 적용 기준이 다릅니다.

| 면적 종류       | 설명                                                         | 주요 적용 항목                                        |
| --------------- | ------------------------------------------------------------ | ----------------------------------------------------- |
| **전용면적**    | 세대가 독립적으로 사용하는 실내 공간의 면적입니다. (예: 방, 거실, 주방, 화장실) | `장기수선충당금` (공동주택관리법)                     |
| **공급면적**    | 전용면적에 복도, 계단, 현관 등 주거 공용면적을 더한 면적입니다. | `일반관리비`, `청소비` 등 대부분의 공용관리비         |
| **계약면적**    | 공급면적에 주차장, 노인정, 관리사무소 등 기타 공용면적까지 포함한 최종 계약상의 면적입니다. | 상가, 오피스 등 상업용 건물에서의 대부분의 공용관리비 |
| **지분(Share)** | 특정 공용 비용에 대해 각 세대가 부담하기로 약정한 상대적인 비율입니다. 면적과 다를 수 있으며, 특정 그룹에만 적용될 수 있습니다. | 특정 그룹 전용 시설 비용 배분                         |



