# 🗣️ QIRO - 민원 처리 관리 기능 명세서

## 1. 문서 정보
- **문서명:** QIRO - 민원 처리 관리 기능 명세서
- **기능 ID (선택 사항):** F-COMPMGMT-001 (Complaint Management)
- **관련 요구사항 ID:** (예: QIRO-FR-CM-001 ~ QIRO-FR-CM-015)
- **관련 사용자 스토리 ID:** (예: US-BM-XXX, US-TENANT-XXX - 입주민 포털 연동 시)
- **작성일:** 2025년 06월 03일
- **최종 수정일:** 2025년 06월 03일
- **작성자:** QIRO 기획팀
- **검토자/승인자 (선택 사항):** (이름 또는 팀)
- **문서 버전:** 1.0

## 2. 기능 개요
### 2.1. 목적
입주민 또는 임차인으로부터 발생하는 다양한 민원(예: 시설 하자 보수 요청, 생활 불편 신고, 관리 문의 등)을 효과적으로 접수, 분류, 담당자 배정, 처리, 결과 통보 및 이력 관리를 수행한다. 이를 통해 민원 처리의 신속성과 투명성을 높이고, 입주민 만족도를 향상시키며, 건물 관리 업무의 효율성을 증진시킨다.

### 2.2. 설명
본 기능은 관리자가 민원을 시스템에 등록하고, 등록된 민원의 처리 과정을 단계별(접수, 처리중, 완료 등)로 추적하며, 각 단계별 조치 내용을 기록할 수 있는 통합 관리 환경을 제공한다. 민원 유형별 분류, 담당자 지정, 처리 기한 설정(선택적), 관련 사진/문서 첨부 등의 기능을 포함한다. (향후 입주민 포털 연동 시, 입주민이 직접 민원을 등록하고 처리 현황을 조회하는 기능까지 확장될 수 있다.)

### 2.3. 범위
- **In-Scope (포함 범위):**
    - 민원 접수: 민원인 정보(호실, 성명, 연락처 - 임차인 관리 연동), 민원 유형 선택, 민원 내용 상세 기술, 사진/동영상 등 증빙 파일 첨부.
    - 민원 목록 조회: 다양한 조건(상태, 유형, 기간, 건물/동, 담당자 등)으로 필터링 및 검색.
    - 민원 상세 정보 조회: 접수 내용, 첨부 파일, 배정 정보, 처리 이력 등.
    - 민원 담당자 배정: 내부 직원 또는 등록된 외부 협력업체(시설관리자) 지정.
    - 민원 처리 상태 변경 관리: `접수됨`, `담당자 배정됨`, `처리중`, `처리 보류`, `처리 완료`, `(민원인) 확인 완료/종결`, `(민원인) 불만족/재처리 요청` 등.
    - 민원 처리 내용 기록: 실제 조치 내용, 사용 부품/비용(간단 기록), 완료 사진 등.
    - 민원 처리 이력 관리 및 조회.
    - (선택) 민원 유형별 표준 처리 절차(SOP) 안내 또는 링크.
    - (선택) 주요 상태 변경 시 민원인 및 담당자에게 자동 알림 연동 (예: 접수 확인, 담당자 배정, 처리 완료).
- **Out-of-Scope (제외 범위):**
    - 민원 처리와 직접 연관된 작업 오더(Work Order)의 상세 관리 (예: 작업 일정 관리, 자재 소요량 관리 등. 이는 별도 "작업 오더 관리" 기능과 연계).
    - 민원 처리 관련 비용의 상세 회계 처리 (이는 "회계 관리" 기능과 연계).
    - 입주민 간 분쟁의 직접적인 중재 기능.
    - 실시간 채팅 기반 상담 기능 (본 기능은 기록 기반의 민원 관리에 중점).

## 3. 사용자 인터페이스 (UI) 및 상호작용
### 3.1. 관련 화면
- `관리자 포털 > 고객 관리 > 민원 관리` (또는 `운영 관리 > 민원 접수 및 처리`)
- (모달 또는 별도 페이지) 신규 민원 등록 폼
- (모달 또는 별도 페이지) 민원 상세 조회 및 처리 화면

### 3.2. UI 요소별 상세 설명 (예시)
- **화면 1: 민원 목록 조회 화면**
    | UI 요소 ID (선택) | 요소명 (Label)            | 유형 (Type)    | 기본값/표시 데이터 | 동작 설명                                                    | 비고                                   |
    | :---------------- | :------------------------ | :------------- | :----------------- | :----------------------------------------------------------- | :------------------------------------- |
    | CP-LST-01         | [건물/동] 필터            | 드롭다운       | 전체               | 특정 건물 또는 동의 민원만 필터링                            |                                        |
    | CP-LST-02         | [민원 유형] 필터          | 드롭다운       | 전체               | 시설하자, 소음, 주차 등 유형별 필터링                        | (민원 유형 마스터 데이터 사용)         |
    | CP-LST-03         | [처리 상태] 필터          | 드롭다운       | 전체               | 접수, 처리중, 완료 등 상태별 필터링                          |                                        |
    | CP-LST-04         | [기간] 필터               | 날짜 범위 선택 | 최근 1개월         | 특정 기간 내 접수된 민원 필터링                              |                                        |
    | CP-LST-05         | [검색] 입력 필드          | 입력 필드      | -                  | 민원 내용, 민원인(호실/성명/연락처), 담당자 등으로 검색      |                                        |
    | CP-LST-06         | [검색/필터 적용] 버튼     | 버튼           | -                  | 조건 적용하여 목록 조회                                      |                                        |
    | CP-LST-07         | `[+ 신규 민원 접수]` 버튼 | 버튼           | -                  | '신규 민원 등록 폼' 화면/모달 호출                           |                                        |
    | CP-LST-08         | 민원 목록                 | 표             | -                  | 접수번호, 접수일, 민원인(호실), 유형, 제목(내용요약), 담당자, 상태, (관리) 등을 표시 | 정렬, 클릭 시 민원 상세 조회 화면 이동 |
    | CP-LST-09         | 페이지네이션              | 페이지네이션   | 1                  | 목록이 많을 경우 페이지 이동                                 |                                        |

- **화면 2: 신규 민원 등록 / 상세 조회 / 처리 화면 (탭 또는 섹션으로 구분 가능)**
    * **모달 또는 페이지 제목:** `신규 민원 접수` / `민원 상세 정보 (접수번호: QCP-20250603-001)`
    * **섹션 1: 민원 기본 정보**
        | UI 요소 ID (선택) | 요소명 (Label)   | 유형 (Type)          | 예시/설명                                                    | 유효성 규칙/제약조건       |
        | :---------------- | :--------------- | :------------------- | :----------------------------------------------------------- | :------------------------- |
        | CP-FRM-01         | 접수일시         | 날짜/시간 (읽기전용) | 시스템 현재 시간 자동 입력 (수정 가능 옵션)                  |                            |
        | CP-FRM-02         | 민원인 호실      | 호실 검색/선택       | (예: 101동 1001호) - 선택 시 임차인 정보 자동 연동 가능      | 필수                       |
        | CP-FRM-03         | 민원인 성명      | 입력 필드/자동표시   | (호실 선택 시 자동 표시, 수정 가능)                          | 필수, 최대 30자            |
        | CP-FRM-04         | 민원인 연락처    | 입력 필드/자동표시   | (호실 선택 시 자동 표시, 수정 가능)                          | 필수, 휴대폰/전화번호 형식 |
        | CP-FRM-05         | 민원 유형        | 드롭다운             | 시설하자(전기/수도/난방 등 세부), 소음, 주차, 청결, 관리문의, 기타 | 필수                       |
        | CP-FRM-06         | 민원 제목 (선택) | 입력 필드            | 민원 내용 요약                                               | 최대 100자                 |
        | CP-FRM-07         | 민원 상세 내용   | 여러 줄 텍스트 영역  | 육하원칙에 따른 상세 내용 기술                               | 필수, 최대 2000자          |
        | CP-FRM-08         | 첨부 파일        | 파일 업로드          | 사진, 동영상 등 증빙 자료 (다중 파일, 미리보기 지원)         | 파일 형식/크기 제한        |
    * **섹션 2: 민원 처리 정보 (상세 조회 또는 처리 단계에서 활성화)**
        | UI 요소 ID (선택) | 요소명 (Label)      | 유형 (Type)           | 예시/설명                                                 | 유효성 규칙/제약조건       |
        | :---------------- | :------------------ | :-------------------- | :-------------------------------------------------------- | :------------------------- |
        | CP-PROC-01        | 처리 상태           | 드롭다운              | 접수됨, 담당자배정됨, 처리중, 처리보류, 처리완료, 종결 등 | 필수 (상태 변경 로직 따름) |
        | CP-PROC-02        | 담당자 지정         | 사용자/업체 검색/선택 | 내부 직원 또는 등록된 외부 협력업체 선택                  | (상태에 따라) 필수         |
        | CP-PROC-03        | 처리 예정일 (선택)  | 날짜 선택             |                                                           |                            |
        | CP-PROC-04        | 처리 내용           | 여러 줄 텍스트 영역   | 실제 조치한 내용, 사용 부품, 특이사항 등 기록             | ('처리완료' 시) 필수       |
        | CP-PROC-05        | 처리 완료일         | 날짜 선택             |                                                           | ('처리완료' 시) 필수       |
        | CP-PROC-06        | 처리 결과 사진/문서 | 파일 업로드           |                                                           |                            |
    * **섹션 3: 처리 이력 (상세 조회 시)**
        * 민원 상태 변경, 담당자 변경, 주요 내용 업데이트 등의 이력을 시간순으로 표시 (변경일시, 변경자, 변경내용).
    * **버튼 영역:**
        * `[접수/저장]`, `[수정]`, `[담당자 배정]`, `[처리 상태 변경]`, `[처리 내용 등록]`, `[닫기]` 등 상황에 맞는 버튼 제공.

#### 3.3. 주요 사용자 시나리오 (흐름)
- **시나리오 1: 관리자에 의한 신규 민원 접수**
    1. 관리자가 '민원 목록 조회 화면'에서 `[+ 신규 민원 접수]` 버튼을 클릭한다.
    2. '신규 민원 등록 폼'이 표시된다.
    3. 관리자가 민원인 정보(호실 검색 후 자동완성 또는 직접 입력), 민원 유형, 상세 내용 등을 입력하고 필요시 파일을 첨부한다.
    4. `[접수]` 버튼을 클릭한다.
    5. 시스템은 민원 정보를 저장하고, 고유 접수번호를 부여하며, 초기 상태를 '접수됨'으로 설정한다. "민원이 정상적으로 접수되었습니다 (접수번호: ...)." 메시지를 표시한다.
    6. (선택) 민원인에게 접수 확인 알림(SMS/이메일)이 발송된다.
- **시나리오 2: 접수된 민원에 담당자 배정**
    1. 관리자가 '민원 목록'에서 '접수됨' 상태의 민원을 선택하여 상세 조회 화면으로 이동한다.
    2. `[담당자 배정]` 버튼(또는 해당 섹션)을 클릭한다.
    3. 시스템에 등록된 내부 직원 또는 외부 협력업체 목록에서 담당자를 검색하여 지정한다. (필요시 처리 예정일 입력)
    4. [저장] 또는 [배정 완료] 버튼을 클릭한다.
    5. 시스템은 민원의 담당자를 업데이트하고, 처리 상태를 '담당자배정됨' 또는 '처리중'으로 변경한다.
    6. (선택) 배정된 담당자 및 민원인에게 담당자 배정 알림이 발송된다.
- **시나리오 3: 민원 처리 결과 입력 및 완료 처리**
    1. 배정된 담당자(또는 관리자)가 민원 처리를 완료한 후, 해당 민원의 상세 조회 화면으로 이동한다.
    2. `[처리 내용 등록]` 버튼(또는 해당 섹션)을 클릭한다.
    3. 실제 조치한 내용, 사용된 부품(선택), 처리 완료일 등을 입력하고, 필요시 완료 사진/문서를 첨부한다.
    4. 처리 상태를 `[처리 완료]`로 변경하고 저장한다.
    5. 시스템은 처리 내용을 저장하고 상태를 업데이트한다.
    6. (선택) 민원인에게 처리 완료 알림을 발송하고, 만족도 피드백을 요청할 수 있다. (만족도 확인 후 최종 '종결' 상태로 변경)

### 4. 데이터 요구사항
#### 4.1. 입력 데이터
- 민원인 정보: 호실 ID (또는 건물/동/호수), 민원인 성명, 연락처.
- 민원 내용: 민원 유형 코드, 제목(선택), 상세 설명, 첨부 파일(사진, 동영상 등).
- 처리 정보: 담당자 ID(내부 직원 또는 외부 업체), 처리 상태 코드, 처리 내용, 처리 완료일, 처리 관련 첨부 파일.

#### 4.2. 출력 데이터 (화면 표시 및 보고서용)
- 민원 목록 (필터링/검색 결과 포함).
- 민원 상세 정보 (접수 내용, 처리 과정 및 결과, 이력).
- 민원 처리 현황 통계 (유형별, 상태별, 담당자별 등).

#### 4.3. 민원 (Complaint) 엔티티 속성 (예시)
| 속성명 (Attribute)     | 데이터 타입 (Type) | 필수 | 설명                                                         |
| :--------------------- | :----------------- | :--- | :----------------------------------------------------------- |
| `complaintId`          | UUID / Long (PK)   | Y    | 민원 고유 ID (예: QCP-YYYYMMDD-NNNN 형식 자동 채번)          |
| `buildingId`           | UUID / Long (FK)   | Y    | 관련 건물 ID                                                 |
| `unitId`               | UUID / Long (FK)   | Y    | 민원 발생 호실 ID                                            |
| `tenantId`             | UUID / Long (FK)   | N    | (연결 시) 민원 제기 임차인 ID                                |
| `reporterName`         | String             | Y    | 민원 제기자 성명                                             |
| `reporterContact`      | String             | Y    | 민원 제기자 연락처                                           |
| `receivedDateTime`     | DateTime           | Y    | 민원 접수 일시                                               |
| `complaintTypeCode`    | String (FK/Enum)   | Y    | 민원 유형 코드 (예: `FACILITY_REPAIR`, `NOISE`, `PARKING`)   |
| `title`                | String             | N    | 민원 제목                                                    |
| `description`          | Text               | Y    | 민원 상세 내용                                               |
| `status`               | String (Enum)      | Y    | 처리 상태 (예: `RECEIVED`, `ASSIGNED`, `IN_PROGRESS`, `ON_HOLD`, `RESOLVED`, `CLOSED_SATISFIED`, `REOPENED`) |
| `assignedUserId`       | UUID / Long (FK)   | N    | 배정된 내부 담당자 ID (User 참조)                            |
| `assignedVendorId`     | UUID / Long (FK)   | N    | 배정된 외부 협력업체 ID (Vendor 참조)                        |
| `targetCompletionDate` | Date               | N    | 처리 목표일                                                  |
| `resolutionDetails`    | Text               | N    | 최종 처리 내용                                               |
| `completedDateTime`    | DateTime           | N    | 실제 처리 완료 일시                                          |
| `satisfactionScore`    | Integer            | N    | (민원인 피드백) 만족도 점수                                  |
| `satisfactionComment`  | Text               | N    | (민원인 피드백) 의견                                         |
| ... (생성/수정일시 등) |                    |      |                                                              |

#### 4.4. 민원 처리 이력 (ComplaintHistory) 엔티티 (예시)
| 속성명 (Attribute) | 데이터 타입 (Type) | 필수 | 설명                                                         |
| :----------------- | :----------------- | :--- | :----------------------------------------------------------- |
| `historyId`        | UUID / Long (PK)   | Y    | 처리 이력 고유 ID                                            |
| `complaintId`      | UUID / Long (FK)   | Y    | 관련 민원 ID                                                 |
| `actionDateTime`   | DateTime           | Y    | 작업 수행 일시                                               |
| `actorUserId`      | UUID / Long (FK)   | Y    | 작업 수행자 ID                                               |
| `actionType`       | String (Enum)      | Y    | 작업 유형 (예: `STATUS_CHANGED`, `ASSIGNED`, `COMMENT_ADDED`, `FILE_ATTACHED`) |
| `previousStatus`   | String (Enum)      | N    | (상태 변경 시) 이전 상태                                     |
| `newStatus`        | String (Enum)      | N    | (상태 변경 시) 새로운 상태                                   |
| `remarks`          | Text               | N    | 작업 관련 상세 내용 또는 메모                                |

#### 4.5. 첨부 파일 (ComplaintAttachment) 엔티티 (예시)
| 속성명 (Attribute) | 데이터 타입 (Type) | 필수 | 설명                                  |
| :----------------- | :----------------- | :--- | :------------------------------------ |
| `attachmentId`     | UUID / Long (PK)   | Y    | 첨부파일 고유 ID                      |
| `complaintId`      | UUID / Long (FK)   | Y    | 관련 민원 ID                          |
| `historyId`        | UUID / Long (FK)   | N    | (처리 이력 첨부 시) 관련 처리 이력 ID |
| `fileName`         | String             | Y    | 파일 원본명                           |
| `filePathOrKey`    | String             | Y    | 저장 경로 또는 S3 Key                 |
| `fileSize`         | Long               | Y    | 파일 크기 (bytes)                     |
| `fileType`         | String             | Y    | 파일 MIME 타입                        |
| `uploadedAt`       | DateTime           | Y    | 업로드 일시                           |

### 5. 처리 로직 및 비즈니스 규칙
- **R-COMPMGMT-001:** 신규 민원 접수 시, 시스템은 고유한 접수번호를 자동으로 생성하고 초기 상태를 '접수됨'으로 설정한다.
- **R-COMPMGMT-002:** 민원 처리 상태는 정의된 워크플로우에 따라 순차적으로 변경되어야 한다. (예: '접수됨' -> '담당자배정됨' -> '처리중' -> '처리완료' -> '종결') 특정 상태에서는 이전 상태로의 변경(롤백)이 제한될 수 있다.
- **R-COMPMGMT-003:** 담당자(내부 직원 또는 외부 협력업체)가 배정되면, 해당 담당자에게 알림이 전달될 수 있다 (알림 서비스 연동).
- **R-COMPMGMT-004:** 민원 처리 내용 등록 시, 처리 완료일 및 상세 내용을 필수로 입력받을 수 있다.
- **R-COMPMGMT-005 (선택적 SLA):** 민원 유형별로 표준 처리 기한(SLA)을 설정하고, 기한 초과 임박 또는 초과 시 담당자 및 관리자에게 알림을 줄 수 있다.
- **R-COMPMGMT-006:** 모든 상태 변경, 담당자 변경, 주요 내용 업데이트는 '처리 이력'에 자동으로 기록되어야 한다.

### 6. 오류 처리 및 예외 관리
| 오류 코드 (선택) | 발생 조건                               | 오류 메시지 (User-facing)                                    |
| :--------------- | :-------------------------------------- | :----------------------------------------------------------- |
| E-COMPMGMT-01    | 필수 입력 항목(민원 내용, 유형 등) 누락 | "[필드명]은(는) 필수 입력 항목입니다."                       |
| E-COMPMGMT-02    | 유효하지 않은 호실 또는 민원인 정보     | "민원인(호실) 정보가 유효하지 않습니다. 확인 후 다시 시도해주세요." |
| E-COMPMGMT-03    | 첨부 파일 크기/형식 제한 초과           | "첨부 파일의 크기가 너무 크거나 지원하지 않는 형식입니다."   |
| E-COMPMGMT-04    | 권한 없는 사용자의 상태 변경 시도       | "해당 민원의 처리 상태를 변경할 권한이 없습니다."            |

### 7. (기능별) 성능 요구사항
- P-COMPMGMT-01: 민원 목록 조회 (1,000건 기준, 복합 필터 조건) 시 3초 이내 응답.
- P-COMPMGMT-02: 신규 민원 접수 및 저장 시 1.5초 이내 완료.
- P-COMPMGMT-03: 첨부 파일(5MB 이하) 업로드 완료까지 10초 이내 (네트워크 환경 고려).

### 8. (기능별) 보안 요구사항
- S-COMPMGMT-01: 민원 관리 기능은 '총괄관리자', '관리소장', 민원 담당 직원 등 인가된 역할만 접근 가능하다. (역할별 조회/처리 권한 차등)
- S-COMPMGMT-02: 민원 내용 및 첨부 파일에 포함될 수 있는 개인정보는 안전하게 보호(암호화 등)되어야 하며, 개인정보보호법을 준수한다.
- S-COMPMGMT-03: 외부 협력업체 담당자에게 민원 배정 시, 해당 민원 건에 대한 정보만 제한적으로 접근할 수 있도록 통제한다.

### 9. 다른 기능/모듈과의 연관성
- **임차인 관리 / 호실 정보 관리:** 민원인 정보(성명, 연락처) 및 민원 발생 위치(호실) 정보를 참조하고 연동한다.
- **시설 관리 협력업체 관리:** 하자보수 등 특정 민원 처리 시, 등록된 외부 협력업체 정보를 참조하여 담당자로 지정할 수 있다.
- **시설 점검 및 유지보수 관리:** 특정 시설물에 대한 하자로 민원이 접수된 경우, 해당 시설물의 점검/수리 이력과 연계될 수 있다.
- **(향후 확장) 작업 오더 관리:** 복잡한 수리/보수가 필요한 민원의 경우, 본 민원 정보를 바탕으로 별도의 작업 오더를 생성하고 관리하는 기능과 연동될 수 있다.
- **알림 서비스:** 민원 접수, 담당자 배정, 처리 완료 등 주요 단계마다 관련자(민원인, 담당자, 관리자)에게 SMS/이메일/앱푸시 등으로 알림을 발송하는 기능과 연동된다.
- **보고서/통계 관리:** 민원 유형별 발생 빈도, 평균 처리 시간, 담당자별 처리 건수 등 통계 데이터를 제공하여 서비스 개선 및 운영 효율화에 활용된다.

### 10. (선택 사항) 테스트 고려 사항
- 다양한 민원 유형 및 내용으로 신규 민원 접수 및 처리 상태 변경 전체 흐름 테스트.
- 파일 첨부(다양한 형식, 크기) 및 조회 기능 테스트.
- 모든 필터 및 검색 조건 조합에 대한 결과 정확성 테스트.
- 담당자(내부/외부) 배정 및 알림 연동 테스트 (구현 시).
- 민원 처리 이력 정확성 검증.
- 권한 없는 사용자의 민원 접근 및 수정 시도 시 차단 여부 테스트.

### 11. 용어 정의 (선택 사항)
- **민원 (Complaint/Request):** 입주민 또는 임차인이 건물 관리와 관련하여 제기하는 모든 종류의 요청, 문의, 불만, 신고 사항.
- **처리 상태 (Resolution Status):** 민원이 접수되어 종결되기까지 거치는 각 단계 (예: 접수됨, 처리중, 완료됨).
- **SLA (Service Level Agreement):** (선택적 도입 시) 민원 유형별 표준 처리 완료 시간 목표.

### 12. 문서 이력
| 버전 | 날짜             | 작성자      | 주요 변경 내용      |
| :--- | :--------------- | :---------- | :------------------ |
| 1.0  | 2025년 06월 03일 | QIRO 기획팀 | 초기 명세서 안 작성 |

---