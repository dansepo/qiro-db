# Phase 1: 기본 건물 관리 구조 구축

## 목표
건물 업무관리의 기반이 되는 기본 데이터 구조와 테이블을 구축합니다.

## 태스크 목록

### 1. 건물 및 호실 관리 구조 확장
- [x] 1.0 기본 건물 테이블 생성 완료 (기존 시스템)
  - ✅ buildings 테이블 기본 구조
  - ✅ company_id 기반 멀티테넌시 적용
  - ✅ 기본 인덱스 및 제약조건
- [✅] 1.1 건물 상세 정보 테이블 확장 (완료)
  - 건물 기본 정보 (주소, 규모, 준공일 등)
  - 건물 관리 정보 (관리사무소, 관리인 등)
  - 건물 시설 정보 (엘리베이터, 주차장 등)

- [✅] 1.2 호실(Unit) 관리 테이블 생성 (완료)
  - 호실 기본 정보 (호수, 면적, 타입 등)
  - 호실 상태 관리 (입주, 공실, 수리중 등)
  - 호실별 관리비 정보

- [✅] 1.3 공용시설 관리 테이블 생성 (완료)
  - 시설 분류 및 위치 정보
  - 시설 상태 및 관리 이력
  - 시설별 관리 담당자

### 2. 입주자 및 임대인 관리 구조
- [x] 2.0 기본 사용자 관리 시스템 완료 (기존 시스템)
  - ✅ users 테이블 (멀티테넌시 적용)
  - ✅ roles 및 user_role_links 테이블
  - ✅ 사용자 권한 관리 시스템
- [✅] 2.1 입주자(Tenant) 정보 테이블 생성 (완료)
  - 개인/법인 구분 관리
  - 연락처 및 비상연락처
  - 입주 이력 관리

- [✅] 2.2 임대인(Lessor) 정보 테이블 생성 (완료)
  - 소유자 정보 관리
  - 임대 조건 및 계약 정보
  - 세금 및 회계 정보

- [✅] 2.3 계약 관리 테이블 생성 (완료)
  - 임대차 계약 정보
  - 계약 갱신 이력
  - 보증금 및 월세 관리

### 3. 기본 코드 및 설정 테이블
- [✅] 3.1 공통 코드 테이블 생성 (완료)
  - 건물 타입, 호실 타입
  - 관리비 항목 코드
  - 시설 분류 코드

- [✅] 3.2 관리비 항목 마스터 테이블 (완료)
  - 관리비 항목별 설정
  - 계산 방식 및 요율
  - 적용 기간 관리

- [✅] 3.3 시스템 설정 테이블 (완료)
  - 건물별 관리 정책
  - 알림 및 메시지 설정
  - 권한 및 접근 제어 설정

### 4. 감사 및 로그 시스템
- [✅] 4.1 데이터 변경 이력 테이블 (완료) ✨
  - 모든 중요 데이터 변경 추적
  - 변경 사유 및 승인 이력
  - 롤백 지원을 위한 이력 관리

- [✅] 4.2 사용자 활동 로그 테이블 (완료) ✨
  - 로그인/로그아웃 이력
  - 주요 기능 사용 이력
  - 보안 관련 이벤트 로그

### 5. 성능 최적화 및 인덱스
- [x] 5.0 기본 성능 최적화 완료 (기존 시스템)
  - ✅ 51개 성능 최적화 인덱스 생성
  - ✅ 멀티테넌시 RLS 정책 최적화
  - ✅ 쿼리 성능 1ms 내외 달성
- [✅] 5.1 건물 관리 전용 인덱스 생성 (완료)
  - 조회 성능 최적화 인덱스
  - 외래키 성능 인덱스
  - 복합 인덱스 설계

- [⏭️] 5.2 파티셔닝 전략 수립 (스킵)
  - 대용량 데이터 테이블 파티셔닝
  - 월별/연도별 데이터 분할
  - 아카이빙 전략 수립

## 검증 기준
- [x] 기본 테이블 생성 완료 (기존 시스템)
- [x] 외래키 제약조건 설정 완료 (기존 시스템)
- [x] 기본 데이터 입력/조회 정상 동작 확인
- [x] 성능 요구사항 만족 (조회 < 1ms 달성)
- [x] 멀티테넌시 격리 정상 동작 확인
- [ ] 확장 테이블들이 정상 생성되었는가?
- [ ] 새로운 비즈니스 로직이 정상 동작하는가?

## 예상 소요 시간: 1-2주