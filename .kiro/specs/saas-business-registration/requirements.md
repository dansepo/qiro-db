# 요구사항 문서

## 소개

QIRO 건물 관리 SaaS 플랫폼에서 사업자 회원가입 및 멀티테넌시 구조를 위한 데이터베이스 설계입니다. 이 기능은 건물 관리 서비스를 이용하고자 하는 사업자들이 안전하고 신뢰할 수 있는 방식으로 회원가입을 하고, 복수의 건물을 그룹 단위로 관리하며, 각 그룹에 담당자를 배치할 수 있는 멀티테넌시 시스템을 구축합니다. 사업자등록번호 검증, 본인 인증, 조직 관리, 건물 그룹 관리, 담당자 배치 등을 포함한 포괄적인 회원가입 및 조직 관리 시스템입니다.

## 요구사항

### 요구사항 1

**사용자 스토리:** 건물 관리 사업자로서, 나는 사업자등록번호와 기본 정보를 입력하여 회원가입을 할 수 있기를 원한다. 그래야 QIRO 건물 관리 서비스를 이용할 수 있다.

#### 수락 기준

1. WHEN 사업자가 회원가입 폼을 제출할 때 THEN 시스템은 사업자등록번호의 유효성을 검증해야 한다
2. WHEN 사업자등록번호가 유효할 때 THEN 시스템은 국세청 API를 통해 사업자 정보를 실시간으로 조회해야 한다
3. WHEN 사업자 정보 조회가 성공할 때 THEN 시스템은 Organization(조직) 엔티티를 생성하고 총괄관리자 계정을 생성해야 한다
4. WHEN 이미 등록된 사업자등록번호로 가입을 시도할 때 THEN 시스템은 중복 가입을 방지해야 한다
5. WHEN 가입이 완료될 때 THEN 시스템은 해당 조직의 멀티테넌시 환경을 초기화해야 한다

### 요구사항 2

**사용자 스토리:** 사업자로서, 나는 대표자 본인 인증을 통해 계정의 신뢰성을 확보하고 싶다. 그래야 안전하게 서비스를 이용할 수 있다.

#### 수락 기준

1. WHEN 사업자가 본인 인증을 요청할 때 THEN 시스템은 대표자 명의의 휴대폰 인증을 제공해야 한다
2. WHEN 휴대폰 인증이 완료될 때 THEN 시스템은 인증 상태를 업데이트하고 계정을 활성화해야 한다
3. WHEN 본인 인증이 완료될 때 THEN 시스템은 총괄관리자 권한을 부여해야 한다
4. WHEN 인증 정보가 불일치할 때 THEN 시스템은 재인증을 요구해야 한다

### 요구사항 3

**사용자 스토리:** 총괄관리자로서, 나는 우리 회사가 관리하는 복수의 건물을 등록하고 관리 단위별로 그룹을 설정하고 싶다. 그래야 효율적으로 건물을 관리할 수 있다.

#### 수락 기준

1. WHEN 총괄관리자가 건물을 등록할 때 THEN 시스템은 해당 조직에 속한 건물로 저장해야 한다
2. WHEN 건물 그룹을 생성할 때 THEN 시스템은 관리 목적에 따른 그룹(배분 그룹, 업무 담당 그룹 등)을 생성해야 한다
3. WHEN 건물을 그룹에 배정할 때 THEN 시스템은 하나의 건물이 여러 그룹에 속할 수 있도록 해야 한다
4. WHEN 그룹을 수정할 때 THEN 시스템은 그룹 정보와 소속 건물 정보를 업데이트해야 한다

### 요구사항 4

**사용자 스토리:** 총괄관리자로서, 나는 직원 계정을 생성하고 각 건물 그룹에 담당자를 배치하고 싶다. 그래야 업무를 효율적으로 분담할 수 있다.

#### 수락 기준

1. WHEN 총괄관리자가 직원 계정을 생성할 때 THEN 시스템은 해당 조직에 속한 내부 사용자로 생성해야 한다
2. WHEN 직원에게 역할을 부여할 때 THEN 시스템은 관리소장, 경리담당자 등의 역할을 할당해야 한다
3. WHEN 담당자를 그룹에 배정할 때 THEN 시스템은 복수의 담당자가 하나의 그룹에 속할 수 있도록 해야 한다
4. WHEN 담당자를 그룹에 배정할 때 THEN 시스템은 한 명의 담당자가 복수의 그룹에 속할 수 있도록 해야 한다

### 요구사항 5

**사용자 스토리:** 관리소장으로서, 나는 내가 담당하는 건물 그룹의 정보만 접근하고 관리하고 싶다. 그래야 권한에 맞는 업무를 수행할 수 있다.

#### 수락 기준

1. WHEN 관리소장이 로그인할 때 THEN 시스템은 해당 사용자가 담당하는 그룹의 건물 정보만 표시해야 한다
2. WHEN 관리소장이 데이터를 조회할 때 THEN 시스템은 담당 그룹의 데이터만 접근을 허용해야 한다
3. WHEN 관리소장이 업무를 수행할 때 THEN 시스템은 역할에 맞는 기능만 접근을 허용해야 한다
4. WHEN 담당 그룹이 변경될 때 THEN 시스템은 접근 권한을 즉시 업데이트해야 한다

### 요구사항 6

**사용자 스토리:** 시스템 관리자로서, 나는 각 조직의 데이터가 완전히 분리되고 보안이 유지되는 멀티테넌시 환경을 보장하고 싶다. 그래야 플랫폼의 신뢰성을 유지할 수 있다.

#### 수락 기준

1. WHEN 사용자가 데이터에 접근할 때 THEN 시스템은 해당 사용자의 조직 데이터만 접근을 허용해야 한다
2. WHEN 데이터를 저장할 때 THEN 시스템은 조직 식별자를 포함하여 저장해야 한다
3. WHEN 조직 간 데이터 접근을 시도할 때 THEN 시스템은 접근을 차단해야 한다
4. WHEN 민감한 정보를 저장할 때 THEN 시스템은 적절한 암호화를 적용해야 한다

### 요구사항 7

**사용자 스토리:** 총괄관리자로서, 나는 조직의 구조 변경과 직원 이동을 유연하게 관리하고 싶다. 그래야 조직 운영의 변화에 대응할 수 있다.

#### 수락 기준

1. WHEN 조직 구조를 변경할 때 THEN 시스템은 기존 데이터의 무결성을 유지해야 한다
2. WHEN 직원의 담당 그룹을 변경할 때 THEN 시스템은 권한을 즉시 업데이트해야 한다
3. WHEN 직원이 퇴사할 때 THEN 시스템은 해당 계정을 비활성화하고 접근 권한을 제거해야 한다
4. WHEN 그룹을 삭제할 때 THEN 시스템은 관련된 모든 연결 관계를 안전하게 처리해야 한다